<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Formal Access Types</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert1 {text-decoration: underline; color: rgb(0,51,51) }
    SPAN.delete1 {text-decoration: line-through; color: rgb(0,51,51) }
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.SyntaxIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.4em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-12-5-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-12-5-5.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>12.5.4 Formal Access Types</H1>
<DIV Class="paranum">1/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00442.TXT">AI95-00442-01</A></I>} 
[The <SPAN class="insert2">category</SPAN><SPAN class="delete2">&nbsp;class</SPAN> 
determined for a formal access type is the <SPAN class="insert2">category</SPAN><SPAN class="delete2">&nbsp;class</SPAN> 
of all access types.]&nbsp;</DIV>
<DIV Class="paranum">1.a/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Proof:&nbsp;</B></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00442.TXT">AI95-00442-01</A></I>} 
<SPAN class="insert2">This rule follows from the rule in <A HREF="AA-12-5.html">12.5</A> 
that says that the category is determined by the one given in the name 
of the syntax production. The effect of the rule is repeated here to 
give a capsule summary of what this subclause is about.</SPAN>&nbsp;</DIV>

<H4 Class="centered">Syntax</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="SyntaxIndented"><SPAN Class="swiss">formal_access_type_definition</SPAN><A NAME="I4830"></A><A NAME="S0273"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><A NAME="I4831"></A><SPAN Class="swiss"><A HREF="AA-3-10.html#S0079">access_type_definition</A></SPAN></DIV>

<H4 Class="centered">Legality Rules</H4>
<DIV Class="paranum">3</DIV>
<DIV Class="Normal">For a formal access-to-object type, the designated 
subtypes of the formal and actual types shall statically match. <SPAN STYLE="font-size: 80%">{<I>statically 
matching (required)</I> [partial]}</SPAN> <A NAME="I4832"></A></DIV>
<DIV Class="paranum">4/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00231.TXT">AI95-00231-01</A></I>} 
If and only if the <SPAN Class="swiss"><A HREF="AA-3-10.html#S0081">general_access_modifier</A></SPAN> 
<B>constant</B> applies to the formal, the actual shall be an access-to-constant 
type. If the <SPAN Class="swiss"><A HREF="AA-3-10.html#S0081">general_access_modifier</A></SPAN> 
<B>all</B> applies to the formal, then the actual shall be a general 
access-to-variable type (see <A HREF="AA-3-10.html">3.10</A>).<SPAN class="insert2">&nbsp;If and only if the formal subtype excludes null, the actual subtype shall 
exclude null.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">4.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>If no <SPAN Class="swiss">_modifier</SPAN> 
applies to the formal, then the actual type may be either a pool-specific 
or a general access-to-variable type.&nbsp;</DIV>
<DIV Class="paranum">4.a.1/1</DIV>
<DIV Class="Annotations"><SPAN class="insert1"><B>Reason:&nbsp;</B></SPAN>{<I><A HREF="defect2.html#8652/0109">8652/0109</A></I>} 
<SPAN class="insert1"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00025.TXT">AI95-00025-01</A></I>} 
<SPAN class="insert1">Matching an access-to-variable to a formal access-to-constant 
type cannot be allowed. If it were allowed, it would be possible to create 
an access-to-variable value designating a constant.</SPAN></DIV>
<DIV Class="paranum">4.b/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00231.TXT">AI95-00231-01</A></I>} 
<SPAN class="insert2">We require that the &ldquo;excludes null&rdquo; 
property match, because it would be difficult to write a correct generic 
for a formal access type without knowing this property. Many typical 
algorithms and techniques will not work for a subtype that excludes null 
(setting an unused component to <B>null</B>, default-initialized objects, 
and so on). Even Ada.Unchecked_Deallocation would fail for a subtype 
that excludes null. Most generics would end up with comments saying that 
they are not intended to work for subtypes that exclude null. We would 
rather that this sort of requirement be reflected in the contract of 
the generic.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">5</DIV>
<DIV Class="Normal">For a formal access-to-subprogram subtype, the designated 
profiles of the formal and the actual shall be mode-conformant, and the 
calling convention of the actual shall be <I>protected</I> if and only 
if that of the formal is <I>protected</I>. <SPAN STYLE="font-size: 80%">{<I>mode 
conformance (required)</I>}</SPAN> <A NAME="I4833"></A></DIV>
<DIV Class="paranum">5.a</DIV>
<DIV Class="Annotations"><B>Reason:&nbsp;</B>We considered requiring subtype 
conformance here, but mode conformance is more flexible, given that there 
is no way in general to specify the convention of the formal.&nbsp;</DIV>

<H4 Class="centered">Examples</H4>
<DIV Class="paranum">6</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><I>Example of formal 
access types:</I>&nbsp;</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Examples">--<SPAN Class="roman"><I>&nbsp;&nbsp;the&nbsp;formal&nbsp;types&nbsp;of&nbsp;the&nbsp;generic&nbsp;package&nbsp;</I></SPAN></DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="Examples"><B>generic</B><BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Node&nbsp;<B>is</B>&nbsp;<B>private</B>;<BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Link&nbsp;<B>is</B>&nbsp;<B>access</B>&nbsp;Node;<BR>
<B>package</B>&nbsp;P&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;...<BR>
<B>end</B>&nbsp;P;</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Examples">--<SPAN Class="roman"><I>&nbsp;&nbsp;can&nbsp;be&nbsp;matched&nbsp;by&nbsp;the&nbsp;actual&nbsp;types&nbsp;</I></SPAN></DIV>
<DIV Class="paranum">10</DIV>
<DIV Class="Examples"><B>type</B>&nbsp;Car;<BR>
<B>type</B>&nbsp;Car_Name&nbsp;<B>is</B>&nbsp;<B>access</B>&nbsp;Car;</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Examples"><B>type</B>&nbsp;Car&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;<B>record</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pred,&nbsp;Succ&nbsp;:&nbsp;Car_Name;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;License_Number;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Owner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Person;<BR>
&nbsp;&nbsp;&nbsp;<B>end</B>&nbsp;<B>record</B>;</DIV>
<DIV Class="paranum">12</DIV>
<DIV Class="Examples">--<SPAN Class="roman"><I>&nbsp;&nbsp;in&nbsp;the&nbsp;following&nbsp;generic&nbsp;instantiation&nbsp;</I></SPAN></DIV>
<DIV Class="paranum">13</DIV>
<DIV Class="Examples"><B>package</B>&nbsp;R&nbsp;<B>is</B>&nbsp;<B>new</B>&nbsp;P(Node&nbsp;=&gt;&nbsp;Car,&nbsp;Link&nbsp;=&gt;&nbsp;Car_Name);</DIV>

<H4 Class="centered">Incompatibilities With Ada 83</H4>
<DIV Class="paranum">13.a</DIV>
<DIV Class="Annotations">{<I>incompatibilities with Ada 83</I>} <A NAME="I4834"></A>The 
check for matching of designated subtypes is changed from a run-time 
check to a compile-time check. The Ada 83 rule that &ldquo;If the designated 
type is other than a scalar type, then the designated subtypes shall 
be either both constrained or both unconstrained&rdquo; is removed, since 
it is subsumed by static matching.&nbsp;</DIV>

<H4 Class="centered">Extensions to Ada 83</H4>
<DIV Class="paranum">13.b</DIV>
<DIV Class="Annotations">{<I>extensions to Ada 83</I>} <A NAME="I4835"></A>Formal 
access-to-subprogram subtypes and formal general access types are new 
concepts.&nbsp;</DIV>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<DIV Class="paranum">13.c/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00231.TXT">AI95-00231-01</A></I>} 
<SPAN class="insert2">Added a matching rule for subtypes that exclude 
null.</SPAN></DIV>
<DIV Class="paranum">13.d/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00442.TXT">AI95-00442-01</A></I>} 
<SPAN class="insert2">We change to &ldquo;determines a category&rdquo; 
as that is the new terminology (it avoids confusion, since not all interesting 
properties form a class).</SPAN>&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-12-5-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-12-5-5.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
