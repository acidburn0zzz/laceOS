<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Accuracy Requirements for Complex Arithmetic</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert1 {text-decoration: underline; color: rgb(0,51,51) }
    SPAN.delete1 {text-decoration: line-through; color: rgb(0,51,51) }
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.SyntaxIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.4em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-G-2-5.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-G-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>G.2.6 Accuracy Requirements for Complex Arithmetic</H1>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal">In the strict mode, the performance of Numerics.Generic_Complex_Types 
and Numerics.Generic_Complex_Elementary_Functions shall be as specified 
here.&nbsp;</DIV>

<H4 Class="centered">Implementation Requirements</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="Normal">When an exception is not raised, the result of evaluating 
a real function of an instance <I>CT</I> of Numerics.Generic_Complex_Types 
(i.e., a function that yields a value of subtype <I>CT</I>.Real'Base 
or <I>CT</I>.Imaginary) belongs to a result interval defined as for a 
real elementary function (see <A HREF="AA-G-2-4.html">G.2.4</A>).</DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>result interval 
(for a component of the result of evaluating a complex function)</I>}</SPAN> 
<A NAME="I7975"></A>When an exception is not raised, each component of 
the result of evaluating a complex function of such an instance, or of 
an instance of Numerics.Generic_Complex_Elementary_Functions obtained 
by instantiating the latter with <I>CT</I> (i.e., a function that yields 
a value of subtype <I>CT</I>.Complex), also belongs to a <I>result interval</I>. 
The result intervals for the components of the result are either defined 
by a <I>maximum relative error</I> bound or by a <I>maximum box error</I> 
bound. <SPAN STYLE="font-size: 80%">{<I>maximum relative error (for a 
component of the result of evaluating a complex function)</I>}</SPAN> 
<A NAME="I7976"></A>When the result interval for the real (resp., imaginary) 
component is defined by maximum relative error, it is defined as for 
that of a real function, relative to the exact value of the real (resp., 
imaginary) part of the result of the corresponding mathematical function. 
<SPAN STYLE="font-size: 80%">{<I>maximum box error (for a component of 
the result of evaluating a complex function)</I>}</SPAN> <A NAME="I7977"></A>When 
defined by maximum box error, the result interval for a component of 
the result is the smallest model interval of <I>CT</I>.Real that contains 
all the values of the corresponding part of <SPAN Class="roman"><I>f</I></SPAN> 
&middot; (1.0 + <SPAN Class="roman"><I>d</I></SPAN>), where <SPAN Class="roman"><I>f</I></SPAN> 
is the exact complex value of the corresponding mathematical function 
at the given parameter values, <SPAN Class="roman"><I>d</I></SPAN> is 
complex, and |<SPAN Class="roman"><I>d</I></SPAN>| is less than or equal 
to the given maximum box error. <SPAN STYLE="font-size: 80%">{<I>Overflow_Check</I> 
[partial]}</SPAN> <A NAME="I7978"></A><SPAN STYLE="font-size: 80%">{<I>check, 
language-defined (Overflow_Check)</I>}</SPAN> <A NAME="I7979"></A>The 
function delivers a value that belongs to the result interval (or a value 
both of whose components belong to their respective result intervals) 
when both bounds of the result interval(s) belong to the safe range of 
<I>CT</I>.Real; otherwise,&nbsp;</DIV>
<DIV Class="paranum">3.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>The maximum relative error 
could be specified separately for each component, but we do not take 
advantage of that freedom here.&nbsp;</DIV>
<DIV Class="paranum">3.b</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>Note that <SPAN Class="roman"><I>f</I></SPAN> 
&middot; (1.0 + <SPAN Class="roman"><I>d</I></SPAN>) defines a small 
circular region of the complex plane centered at <SPAN Class="roman"><I>f</I></SPAN>, 
and the result intervals for the real and imaginary components of the 
result define a small rectangular box containing that circle.&nbsp;</DIV>
<DIV Class="paranum">3.c</DIV>
<DIV Class="Annotations"><B>Reason:&nbsp;</B>Box error is used when the computation 
of the result risks loss of significance in a component due to cancellation. 
</DIV>
<DIV Class="paranum">3.d</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>The components of a complex 
function that exhibits bounded relative error in each component have 
to have the correct sign. In contrast, one of the components of a complex 
function that exhibits bounded box error may have the wrong sign, since 
the dimensions of the box containing the result are proportional to the 
modulus of the mathematical result and not to either component of the 
mathematical result individually. Thus, for example, the box containing 
the computed result of a complex function whose mathematical result has 
a large modulus but lies very close to the imaginary axis might well 
straddle that axis, allowing the real component of the computed result 
to have the wrong sign. In this case, the distance between the computed 
result and the mathematical result is, nevertheless, a small fraction 
of the modulus of the mathematical result.&nbsp;</DIV>
<DIV Class="paranum">4</DIV>
<UL Class="Bulleted"><LI TYPE=DISC><SPAN STYLE="font-size: 80%">{<I>Constraint_Error 
(raised by failure of run-time check)</I>}</SPAN> <A NAME="I7980"></A>if 
<I>CT</I>.Real'Machine_Overflows is True, the function either delivers 
a value that belongs to the result interval (or a value both of whose 
components belong to their respective result intervals) or raises Constraint_Error, 
signaling overflow;</LI></UL>
<DIV Class="paranum">5</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>if <I>CT</I>.Real'Machine_Overflows 
is False, the result is implementation defined.&nbsp;</LI></UL>
<DIV Class="paranum">5.a</DIV>
<DIV Class="Annotations"><B>Implementation defined:&nbsp;</B>The result of 
a complex arithmetic operation or complex elementary function reference 
in overflow situations, when the Machine_Overflows attribute of the corresponding 
real type is False.</DIV>
<DIV Class="paranum">6/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
The error bounds for particular complex functions are tabulated <SPAN class="insert2">in 
table G-2</SPAN><SPAN class="delete2">&nbsp;below</SPAN>. In the table, the 
error bound is given as the coefficient of <I>CT</I>.Real'Model_Epsilon.</DIV>
<DIV Class="paranum">7/1</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%"><I>This paragraph was 
deleted.</I></SPAN><SPAN class="delete1">&nbsp;</SPAN></DIV>
<DIV Class="SyntaxIndented"><TABLE frame="border" rules="all" border="2" cellpadding="4"><CAPTION><B></B><SPAN class="insert2"><B>Table G-2:&nbsp;</B></SPAN><B>Error 
Bounds for Particular Complex Functions</B></CAPTION>
<TR><TH align="center"><B>Function or Operator</B><TH align="center"><B>Nature 
of <BR>
Result</B><TH align="center"><B>Nature of <BR>
Bound</B><TH align="center"><B>Error Bound</B>
<TR><TD align="center">Modulus<TD align="center">real<TD align="center">max. 
rel. error<TD align="center">3.0
<TR><TD align="center">Argument<TD align="center">real<TD align="center">max. 
rel. error<TD align="center">4.0
<TR><TD align="center">Compose_From_Polar<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">3.0
<TR><TD align="center">&quot;*&quot; (both operands complex)<TD align="center">complex<TD align="center">max. 
box error<TD align="center">5.0
<TR><TD align="center">&quot;/&quot; (right operand complex)<TD align="center">complex<TD align="center">max. 
box error<TD align="center">13.0
<TR><TD align="center">Sqrt<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">6.0
<TR><TD align="center">Log<TD align="center">complex<TD align="center">max. 
box error<TD align="center">13.0
<TR><TD align="center">Exp (complex parameter)<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">7.0
<TR><TD align="center">Exp (imaginary parameter)<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">2.0
<TR><TD align="center">Sin, Cos, Sinh, and Cosh<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">11.0
<TR><TD align="center">Tan, Cot, Tanh, and Coth<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">35.0
<TR><TD align="center">inverse trigonometric<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">14.0
<TR><TD align="center">inverse hyperbolic<TD align="center">complex<TD align="center">max. 
rel. error<TD align="center">14.0
</TABLE></DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="Normal">The maximum relative error given above applies throughout 
the domain of the Compose_From_Polar function when the Cycle parameter 
is specified. When the Cycle parameter is omitted, the maximum relative 
error applies only when the absolute value of the parameter Argument 
is less than or equal to the angle threshold (see <A HREF="AA-G-2-4.html">G.2.4</A>). 
For the Exp function, and for the forward hyperbolic (resp., trigonometric) 
functions, the maximum relative error given above likewise applies only 
when the absolute value of the imaginary (resp., real) component of the 
parameter X (or the absolute value of the parameter itself, in the case 
of the Exp function with a parameter of pure-imaginary type) is less 
than or equal to the angle threshold. For larger angles, the accuracy 
is implementation defined.&nbsp;</DIV>
<DIV Class="paranum">8.a</DIV>
<DIV Class="Annotations"><B>Implementation defined:&nbsp;</B>The accuracy 
of certain complex arithmetic operations and certain complex elementary 
functions for parameters (or components thereof) beyond the angle threshold.</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The prescribed results 
specified in <A HREF="AA-G-1-2.html">G.1.2</A> for certain functions 
at particular parameter values take precedence over the error bounds; 
effectively, they narrow to a single value the result interval allowed 
by the error bounds for a component of the result. Additional rules with 
a similar effect are given below for certain inverse trigonometric and 
inverse hyperbolic functions, at particular parameter values for which 
a component of the mathematical result is transcendental. In each case, 
the accuracy rule, which takes precedence over the error bounds, is that 
the result interval for the stated result component is the model interval 
of <I>CT</I>.Real associated with the component's exact mathematical 
value. The cases in question are as follows:&nbsp;</DIV>
<DIV Class="paranum">10</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>When the parameter X has the value 
zero, the real (resp., imaginary) component of the result of the Arccot 
(resp., Arccoth) function is in the model interval of <I>CT</I>.Real 
associated with the value &pi;/2.0.</LI></UL>
<DIV Class="paranum">11</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>When the parameter X has the value 
one, the real component of the result of the Arcsin function is in the 
model interval of <I>CT</I>.Real associated with the value &pi;/2.0.</LI></UL>
<DIV Class="paranum">12</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>When the parameter X has the value 
&ndash;1.0, the real component of the result of the Arcsin (resp., Arccos) 
function is in the model interval of <I>CT</I>.Real associated with the 
value &ndash;&pi;/2.0 (resp., &pi;).&nbsp;</LI></UL>
<DIV Class="paranum">12.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>It is possible to give many 
other prescribed results in which a component of the parameter is restricted 
to a similar model interval when the parameter X is appropriately restricted 
to an easily testable portion of the domain. We follow the proposed ISO/IEC 
standard for Generic_Complex_Elementary_Functions (for Ada 83) in not 
doing so, however.&nbsp;</DIV>
<DIV Class="paranum">13/2</DIV>
<DIV Class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
The amount by which a component of the result of an inverse trigonometric 
or inverse hyperbolic function is allowed to spill over into a quadrant 
adjacent to the one corresponding to the principal branch, as given in 
<A HREF="AA-G-1-2.html">G.1.2</A>, is limited. The rule is that the result 
belongs to the smallest model interval of <I>CT</I>.Real that contains 
both boundaries of the quadrant corresponding to the principal branch. 
This rule also takes precedence <SPAN class="insert2">over</SPAN><SPAN class="delete2">&nbsp;to</SPAN> 
the maximum error bounds, effectively narrowing the result interval allowed 
by them.</DIV>
<DIV Class="paranum">14</DIV>
<DIV Class="Normal">Finally, the results allowed by the error bounds 
are narrowed by one further rule: The absolute value of each component 
of the result of the Exp function, for a pure-imaginary parameter, never 
exceeds one.&nbsp;</DIV>

<H4 Class="centered">Implementation Advice</H4>
<DIV Class="paranum">15</DIV>
<DIV Class="Normal">The version of the Compose_From_Polar function without 
a Cycle parameter should not be implemented by calling the corresponding 
version with a Cycle parameter of 2.0*Numerics.Pi, since this will not 
provide the required accuracy in some portions of the domain.&nbsp;</DIV>
<DIV Class="paranum">15.a.1/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Implementation Advice: 
</B></SPAN><SPAN class="insert2">For complex arithmetic, the Compose_From_Polar 
function without a Cycle parameter should not be implemented by calling 
Compose_From_Polar with a Cycle parameter.</SPAN></DIV>

<H4 Class="centered">Wording Changes from Ada 83</H4>
<DIV Class="paranum">15.a</DIV>
<DIV Class="Annotations">The semantics of Numerics.Generic_Complex_Types 
and Numerics.Generic_Complex_Elementary_Functions differs from Generic_Complex_Types 
and Generic_Complex_Elementary_Functions as defined in ISO/IEC CDs 13813 
and 13814 (for Ada 83) in ways analogous to those identified for the 
elementary functions in <A HREF="AA-G-2-4.html">G.2.4</A>. In addition, 
we do not generally specify the signs of zero results (or result components), 
although those proposed standards do.&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-G-2-5.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-G-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
