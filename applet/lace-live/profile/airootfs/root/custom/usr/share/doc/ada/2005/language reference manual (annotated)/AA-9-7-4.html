<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Asynchronous Transfer of Control</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Wide {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-top: 0.6em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.SyntaxIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.4em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-7-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-8.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>9.7.4 Asynchronous Transfer of Control</H1>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal">[An asynchronous <SPAN Class="swiss"><A HREF="AA-9-7.html#S0212">select_statement</A></SPAN> 
provides asynchronous transfer of control upon completion of an entry 
call or the expiration of a delay.]&nbsp;</DIV>

<H4 Class="centered">Syntax</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="SyntaxIndented"><SPAN Class="swiss">asynchronous_select</SPAN><A NAME="I4233"></A><A NAME="S0223"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;<B>select</B><BR>
&nbsp;&nbsp;&nbsp;<A NAME="I4234"></A><SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0224">triggering_alternative</A></SPAN><BR>
&nbsp;&nbsp;<B>then&nbsp;abort</B><BR>
&nbsp;&nbsp;&nbsp;<A NAME="I4235"></A><SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN><BR>
&nbsp;&nbsp;<B>end&nbsp;select</B>;</DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="SyntaxIndented"><SPAN Class="swiss">triggering_alternative</SPAN><A NAME="I4236"></A><A NAME="S0224"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><A NAME="I4237"></A><SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN>&nbsp;[<A NAME="I4238"></A><SPAN Class="swiss"><A HREF="AA-5-1.html#S0130">sequence_of_statements</A></SPAN>]</DIV>
<DIV Class="paranum">4/2</DIV>
<DIV Class="SyntaxIndented">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00345.TXT">AI95-00345-01</A></I>} 
<SPAN Class="swiss">triggering_statement</SPAN><A NAME="I4239"></A><A NAME="S0225"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><SPAN class="insert2"><A NAME="I4240"></A><SPAN Class="swiss"><A HREF="AA-9-7-2.html#S0221">procedure_or_entry_call</A></SPAN></SPAN><SPAN class="delete2"><A NAME="I4241"></A><SPAN Class="swiss"><A HREF="AA-9-5-3.html#S0207">&nbsp;entry_call_statement</A></SPAN></SPAN>&nbsp;|&nbsp;<A NAME="I4242"></A><SPAN Class="swiss"><A HREF="AA-9-6.html#S0209">delay_statement</A></SPAN></DIV>
<DIV Class="paranum">5</DIV>
<DIV Class="SyntaxIndented"><SPAN Class="swiss">abortable_part</SPAN><A NAME="I4243"></A><A NAME="S0226"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><A NAME="I4244"></A><SPAN Class="swiss"><A HREF="AA-5-1.html#S0130">sequence_of_statements</A></SPAN></DIV>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">6/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00345.TXT">AI95-00345-01</A></I>} 
<SPAN STYLE="font-size: 80%">{<I>execution (asynchronous_select with 
an entry call trigger)</I> [partial]}</SPAN> <A NAME="I4245"></A><SPAN class="insert2"><SPAN STYLE="font-size: 80%">{<I>execution 
(asynchronous_select with a procedure call trigger)</I> [partial]}</SPAN> 
<A NAME="I4246"></A></SPAN>For the execution of an <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0223">asynchronous_select</A></SPAN> 
whose <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN> 
is <SPAN class="insert2">a <SPAN Class="swiss"><A HREF="AA-9-7-2.html#S0221">procedure_or_entry_call</A></SPAN></SPAN><SPAN class="delete2">&nbsp;an 
<SPAN Class="swiss"><A HREF="AA-9-5-3.html#S0207">entry_call_statement</A></SPAN></SPAN>, 
the <I>entry_</I><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN><SPAN class="insert2">, 
<I>procedure_</I><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN>, 
or <I>procedure_</I><SPAN Class="swiss"><A HREF="AA-4-1.html#S0093">prefix</A></SPAN>,</SPAN> 
and actual parameters are evaluated as for a simple entry call (see <A HREF="AA-9-5-3.html">9.5.3</A>)<SPAN class="insert2">&nbsp;or procedure call (see <A HREF="AA-6-4.html">6.4</A>). If the call is 
an entry call or a call on a procedure implemented by an entry,</SPAN><SPAN class="delete2">, 
and</SPAN> the entry call is issued. If the entry call is queued (or 
requeued-with-abort), then the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is executed. [If the entry call is selected immediately, and never requeued-with-abort, 
then the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is never started.]<SPAN class="insert2">&nbsp;If the call is on a procedure 
that is not implemented by an entry, the call proceeds as described in 
<A HREF="AA-6-4.html">6.4</A>, followed by the <SPAN Class="swiss"><A HREF="AA-5-1.html#S0130">sequence_of_statements</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0224">triggering_alternative</A></SPAN>[; 
the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is never started].</SPAN></DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>execution (asynchronous_select 
with a delay_statement trigger)</I> [partial]}</SPAN> <A NAME="I4247"></A>For 
the execution of an <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0223">asynchronous_select</A></SPAN> 
whose <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN> 
is a <SPAN Class="swiss"><A HREF="AA-9-6.html#S0209">delay_statement</A></SPAN>, 
the <I>delay_</I><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN> 
is evaluated and the expiration time is determined, as for a normal <SPAN Class="swiss"><A HREF="AA-9-6.html#S0209">delay_statement</A></SPAN>. 
If the expiration time has not already passed, the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is executed.</DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="Normal">If the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
completes and is left prior to completion of the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN>, 
an attempt to cancel the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN> 
is made. If the attempt to cancel succeeds (see <A HREF="AA-9-5-3.html">9.5.3</A> 
and <A HREF="AA-9-6.html">9.6</A>), the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0223">asynchronous_select</A></SPAN> 
is complete.</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Normal">If the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN> 
completes other than due to cancellation, the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is aborted (if started but not yet completed &mdash; see <A HREF="AA-9-8.html">9.8</A>). 
If the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN> 
completes normally, the optional <SPAN Class="swiss"><A HREF="AA-5-1.html#S0130">sequence_of_statements</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0224">triggering_alternative</A></SPAN> 
is executed after the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is left.&nbsp;</DIV>
<DIV Class="paranum">9.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>We currently don't specify 
when the by-copy [<B>in</B>] <B>out</B> parameters are assigned back 
into the actuals. We considered requiring that to happen after the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN> 
is left. However, that doesn't seem useful enough to justify possibly 
overspecifying the implementation approach, since some of the parameters 
are passed by reference anyway.</DIV>
<DIV Class="paranum">9.b</DIV>
<DIV Class="Annotations">In an earlier description, we required that 
the <SPAN Class="swiss"><A HREF="AA-5-1.html#S0130">sequence_of_statements</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0224">triggering_alternative</A></SPAN> 
execute after aborting the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0226">abortable_part</A></SPAN>, 
but before waiting for it to complete and finalize, to provide more rapid 
response to the triggering event in case the finalization was unbounded. 
However, various reviewers felt that this created unnecessary complexity 
in the description, and a potential for undesirable concurrency (and 
nondeterminism) within a single task. We have now reverted to simpler, 
more deterministic semantics, but anticipate that further discussion 
of this issue might be appropriate during subsequent reviews. One possibility 
is to leave this area implementation defined, so as to encourage experimentation. 
The user would then have to assume the worst about what kinds of actions 
are appropriate for the <SPAN Class="swiss"><A HREF="AA-5-1.html#S0130">sequence_of_statements</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0224">triggering_alternative</A></SPAN> 
to achieve portability.&nbsp;</DIV>

<H4 Class="centered">Examples</H4>
<DIV Class="paranum">10</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><SPAN STYLE="font-size: 80%">{<I>signal 
handling (example)</I>}</SPAN> <A NAME="I4248"></A><SPAN STYLE="font-size: 80%">{<I>interrupt 
(example using asynchronous_select)</I>}</SPAN> <A NAME="I4249"></A><SPAN STYLE="font-size: 80%">{<I>terminal 
interrupt (example)</I>}</SPAN> <A NAME="I4250"></A><I>Example of a main 
command loop for a command interpreter:</I>&nbsp;</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Examples"><B>loop</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>select</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Terminal.Wait_For_Interrupt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Put_Line(&quot;Interrupted&quot;);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>then&nbsp;abort</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>This&nbsp;will&nbsp;be&nbsp;abandoned&nbsp;upon&nbsp;terminal&nbsp;interrupt</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Put_Line(&quot;-&gt;&nbsp;&quot;);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get_Line(Command,&nbsp;Last);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process_Command(Command(1..Last));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>end</B>&nbsp;<B>select</B>;<BR>
<B>end</B>&nbsp;<B>loop</B>;</DIV>
<DIV Class="paranum">12</DIV>
<DIV Class="Wide" Style="margin-bottom: 0.4em"><I>Example of a time-limited 
calculation:</I> <SPAN STYLE="font-size: 80%">{<I>time-out: See asynchronous_select</I>}</SPAN> 
<A NAME="I4251"></A><SPAN STYLE="font-size: 80%">{<I>time-out (example)</I>}</SPAN> 
<A NAME="I4252"></A><SPAN STYLE="font-size: 80%">{<I>time limit (example)</I>}</SPAN> 
<A NAME="I4253"></A><SPAN STYLE="font-size: 80%">{<I>interrupt (example 
using asynchronous_select)</I>}</SPAN> <A NAME="I4254"></A><SPAN STYLE="font-size: 80%">{<I>timer 
interrupt (example)</I>}</SPAN> <A NAME="I4255"></A></DIV>
<DIV Class="paranum">13</DIV>
<DIV Class="Examples"><B>select</B><BR>
&nbsp;&nbsp;&nbsp;<B>delay</B>&nbsp;5.0;<BR>
&nbsp;&nbsp;&nbsp;Put_Line(&quot;Calculation&nbsp;does&nbsp;not&nbsp;converge&quot;);<BR>
<B>then&nbsp;abort</B><BR>
&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>This&nbsp;calculation&nbsp;should&nbsp;finish&nbsp;in&nbsp;5.0&nbsp;seconds;</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;--&nbsp;<SPAN Class="roman"><I>&nbsp;if&nbsp;not,&nbsp;it&nbsp;is&nbsp;assumed&nbsp;to&nbsp;diverge.</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;Horribly_Complicated_Recursive_Function(X,&nbsp;Y);<BR>
<B>end</B>&nbsp;<B>select</B>;</DIV>

<H4 Class="centered">Extensions to Ada 83</H4>
<DIV Class="paranum">13.a</DIV>
<DIV Class="Annotations">{<I>extensions to Ada 83</I>} <A NAME="I4256"></A><SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0223">Asynchronous_select</A></SPAN> 
is new.&nbsp;</DIV>

<H4 Class="centered">Extensions to Ada 95</H4>
<DIV Class="paranum">13.b/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00345.TXT">AI95-00345-01</A></I>} 
<SPAN class="insert2">{<I>extensions to Ada 95</I>} <A NAME="I4257"></A>A 
procedure can be used as the <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0225">triggering_statement</A></SPAN> 
of an <SPAN Class="swiss"><A HREF="AA-9-7-4.html#S0223">asynchronous_select</A></SPAN>, 
if the procedure might actually be an entry</SPAN>&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-7-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-8.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
