<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Pragma Inspection_Point</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert1 {text-decoration: underline; color: rgb(0,51,51) }
    SPAN.delete1 {text-decoration: line-through; color: rgb(0,51,51) }
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.SyntaxIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.4em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-H-3-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-H-4.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>H.3.2 Pragma Inspection_Point</H1>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal">An occurrence of a pragma Inspection_Point identifies 
a set of objects each of whose values is to be available at the point(s) 
during program execution corresponding to the position of the pragma 
in the compilation unit. The purpose of such a pragma is to facilitate 
code validation.&nbsp;</DIV>
<DIV Class="paranum">1.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>Inspection points are a high 
level equivalent of break points used by debuggers.</DIV>

<H4 Class="centered">Syntax</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="SyntaxIndented" Style="margin-bottom: 0.2em">The form of 
a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> Inspection_Point 
is as follows:&nbsp;</DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="SyntaxIndented">&nbsp;&nbsp;<B>pragma</B> <A NAME="I8055"></A><A NAME="I8056"></A>Inspection_Point[(<I>object_</I><A NAME="I8057"></A><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN> 
{, <I>object_</I><A NAME="I8058"></A><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN>})]; 
</DIV>

<H4 Class="centered">Legality Rules</H4>
<DIV Class="paranum">4</DIV>
<DIV Class="Normal">A pragma Inspection_Point is allowed wherever a <SPAN Class="swiss"><A HREF="AA-3-11.html#S0087">declarative_item</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-5-1.html#S0131">statement</A></SPAN> 
is allowed. Each <I>object_</I>name shall statically denote the declaration 
of an object.&nbsp;</DIV>
<DIV Class="paranum">4.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>The static denotation is 
required, since no dynamic evaluation of a name is involved in this pragma.</DIV>

<H4 Class="centered">Static Semantics</H4>
<DIV Class="paranum">5/2</DIV>
<DIV Class="Normal">{<I><A HREF="defect1.html#8652/0093">8652/0093</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00207.TXT">AI95-00207-01</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
<SPAN STYLE="font-size: 80%">{<I>inspection point</I>}</SPAN> <A NAME="I8059"></A>An 
<I>inspection point</I> is a point in the object code corresponding to 
the occurrence of a pragma Inspection_Point in the compilation unit. 
<SPAN STYLE="font-size: 80%">{<I>inspectable object</I>}</SPAN> <A NAME="I8060"></A>An 
object is <I>inspectable</I> at an inspection point if the corresponding 
pragma Inspection_Point either has an argument denoting that object, 
or has no arguments<SPAN class="insert1">&nbsp;and the&nbsp;</SPAN><SPAN class="insert2">declaration 
of the&nbsp;</SPAN><SPAN class="insert1">object is visible at the inspection 
point</SPAN>.&nbsp;</DIV>
<DIV Class="paranum">5.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>If a pragma Inspection_Point 
is in an in-lined subprogram, there might be numerous inspection points 
in the object code corresponding to the single occurrence of the pragma 
in the source; similar considerations apply if such a pragma is in a 
generic, or in a loop that has been &ldquo;unrolled&rdquo; by an optimizer.</DIV>
<DIV Class="paranum">5.a.1/1</DIV>
<DIV Class="Annotations">{<I><A HREF="defect1.html#8652/0093">8652/0093</A></I>} 
<SPAN class="insert1"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00207.TXT">AI95-00207-01</A></I>} 
<SPAN class="insert1">The short form of the pragma is a convenient shorthand 
for listing all objects which could be explicitly made inspectable by 
the long form of the pragma; thus only visible objects are made inspectable 
by it. Objects that are not visible at the point of the pragma are not 
made inspectable by the short form pragma. This is necessary so that 
implementations need not keep information about (or prevent optimizations 
on) a unit simply because some other unit <I>might</I> contain a short 
form Inspection_Point pragma.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">5.b/1</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>{<I><A HREF="defect1.html#8652/0093">8652/0093</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00207.TXT">AI95-00207-01</A></I>} 
If the short form of the pragma is used, then all<SPAN class="insert1">&nbsp;visible</SPAN> objects are inspectable. This implies that <SPAN class="insert1">global 
objects from other compilation units</SPAN><SPAN class="delete1">&nbsp;objects 
out of scope at the point of the pragma</SPAN> are inspectable. A good 
interactive debugging system could provide information similar to a post-mortem 
dump at such inspection points. The annex does not require that any inspection 
facility is provided, merely that the information is available to understand 
the state of the machine at those points.&nbsp;</DIV>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">6</DIV>
<DIV Class="Normal">Execution of a pragma Inspection_Point has no effect. 
</DIV>
<DIV Class="paranum">6.a/2</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00114.TXT">AI95-00114-01</A></I>} 
Although an inspection point has no (semantic) effect, the removal or 
adding <SPAN class="insert2">of&nbsp;</SPAN>a new point could change the machine 
code generated by the compiler.</DIV>

<H4 Class="centered">Implementation Requirements</H4>
<DIV Class="paranum">7</DIV>
<DIV Class="Normal">Reaching an inspection point is an external interaction 
with respect to the values of the inspectable objects at that point (see 
<A HREF="AA-1-1-3.html">1.1.3</A>).&nbsp;</DIV>
<DIV Class="paranum">7.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>The compiler is inhibited 
from moving an assignment to an inspectable variable past an inspection 
point for that variable. On the other hand, the evaluation of an expression 
that might raise an exception may be moved past an inspection point (see 
<A HREF="AA-11-6.html">11.6</A>).</DIV>

<H4 Class="centered">Documentation Requirements</H4>
<DIV Class="paranum">8</DIV>
<DIV Class="Normal">For each inspection point, the implementation shall 
identify a mapping between each inspectable object and the machine resources 
(such as memory locations or registers) from which the object's value 
can be obtained.&nbsp;</DIV>
<DIV Class="paranum">8.a/2</DIV>
<DIV Class="Annotations"><SPAN STYLE="font-size: 80%"><I>This paragraph 
was deleted.</I></SPAN><SPAN class="delete2"><B>Implementation defined: 
</B></SPAN><SPAN class="delete2">Implementation-defined aspects of pragma 
Inspection_Point.</SPAN></DIV>
<DIV Class="paranum">8.b/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Documentation Requirement: 
</B></SPAN><SPAN class="insert2">For each inspection point, a mapping 
between each inspectable object and the machine resources where the object's 
value can be obtained shall be provided.</SPAN></DIV>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">9/2</DIV>
<DIV Class="Notes">7&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00209.TXT">AI95-00209-01</A></I>} 
The implementation is not allowed to perform &ldquo;dead store elimination&rdquo; 
on the last assignment to a variable prior to a point where the variable 
is inspectable. Thus an inspection point has the effect of an implicit 
<SPAN class="insert2">read of</SPAN><SPAN class="delete2">&nbsp;reference 
to</SPAN> each of its inspectable objects.</DIV>
<DIV Class="paranum">10</DIV>
<DIV Class="Notes">8&nbsp;&nbsp;Inspection points are useful in maintaining 
a correspondence between the state of the program in source code terms, 
and the machine state during the program's execution. Assertions about 
the values of program objects can be tested in machine terms at inspection 
points. Object code between inspection points can be processed by automated 
tools to verify programs mechanically.&nbsp;</DIV>
<DIV Class="paranum">10.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>Although it is not a requirement 
of the annex, it would be useful if the state of the stack and heap could 
be interrogated. This would allow users to check that a program did not 
have a `storage leak'.</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Notes">9&nbsp;&nbsp;The identification of the mapping from 
source program objects to machine resources is allowed to be in the form 
of an annotated object listing, in human-readable or tool-processable 
form.&nbsp;</DIV>
<DIV Class="paranum">11.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>In principle, it is easy 
to check an implementation for this pragma, since one merely needs to 
check the content of objects against those values known from the source 
listing. In practice, one needs a tool similar to an interactive debugger 
to perform the check.</DIV>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<DIV Class="paranum">11.b/2</DIV>
<DIV Class="Annotations">{<I><A HREF="defect1.html#8652/0093">8652/0093</A></I>} 
<SPAN class="insert2"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00207.TXT">AI95-00207-01</A></I>} 
<SPAN class="insert2"><B>Corrigendum:</B> Corrected the definition of 
the Inspection_Point pragma to apply to only variables visible at the 
point of the pragma. Otherwise, the compiler would have to assume that 
some other code somewhere could have a pragma Inspection_Point, preventing 
many optimizations (such as unused object elimination).</SPAN>&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-H-3-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-H-4.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
