<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Program Execution</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B></SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-10-1-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-10-2-1.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>10.2 Program Execution</H1>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal"><A NAME="I4030"></A><A NAME="I4031"></A><A NAME="I4032"></A>An 
Ada <I>program</I> consists of a set of <I>partitions</I>, which can 
execute in parallel with one another, possibly in a separate address 
space, and possibly on a separate computer.&nbsp;</DIV>

<H4 Class="centered">Post-Compilation Rules</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="Normal"><A NAME="I4033"></A><A NAME="I4034"></A>A partition 
is a program or part of a program that can be invoked from outside the 
Ada implementation. For example, on many systems, a partition might be 
an executable file generated by the system linker. <A NAME="I4035"></A>The 
user can <I>explicitly assign</I> library units to a partition. The assignment 
is done in an implementation-defined manner. The compilation units included 
in a partition are those of the explicitly assigned library units, as 
well as other compilation units <I>needed by</I> those library units. 
The compilation units needed by a given compilation unit are determined 
as follows (unless specified otherwise via an implementation-defined 
<SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN>, or 
by some other implementation-defined means): <A NAME="I4036"></A><A NAME="I4037"></A><A NAME="I4038"></A></DIV>
<DIV Class="paranum">3</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>A compilation unit needs itself;</LI></UL>
<DIV Class="paranum">4</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If a compilation unit is needed, then 
so are any compilation units upon which it depends semantically;</LI></UL>
<DIV Class="paranum">5</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If a <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0231">library_unit_declaration</A></SPAN> 
is needed, then so is any corresponding <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0233">library_unit_body</A></SPAN>;</LI></UL>
<DIV Class="paranum">6/2</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If a compilation unit with stubs is 
needed, then so are any corresponding subunits;</LI></UL>
<DIV Class="paranum">6.1/2</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If the (implicit) declaration of the 
limited view of a library package is needed, then so is the explicit 
declaration of the library package.</LI></UL>
<DIV Class="paranum">7</DIV>
<DIV Class="Normal"><A NAME="I4039"></A>The user can optionally designate 
(in an implementation-defined manner) one subprogram as the <I>main subprogram</I> 
for the partition. A main subprogram, if specified, shall be a subprogram. 
</DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="Normal"><A NAME="I4040"></A>Each partition has an anonymous 
<I>environment task</I>, which is an implicit outermost task whose execution 
elaborates the <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
of the environment <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN>, 
and then calls the main subprogram, if there is one. A partition's execution 
is that of its tasks.&nbsp;</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Normal">The order of elaboration of library units is determined 
primarily by the <I>elaboration dependences</I>. <A NAME="I4041"></A><A NAME="I4042"></A>There 
is an elaboration dependence of a given <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN> 
upon another if the given <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN> 
or any of its subunits depends semantically on the other <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>. 
In addition, if a given <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN> 
or any of its subunits has a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Elaborate or Elaborate_All that names another library unit, then there 
is an elaboration dependence of the given <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN> 
upon the body of the other library unit, and, for Elaborate_All only, 
upon each <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN> 
needed by the declaration of the other library unit.&nbsp;</DIV>
<DIV Class="paranum">10</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The environment task 
for a partition has the following structure:&nbsp;</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Examples"><B>task</B>&nbsp;<SPAN Class="roman"><I>Environment_Task</I></SPAN>;</DIV>
<DIV Class="paranum">12/2</DIV>
<DIV Class="Examples"><B>task</B>&nbsp;<B>body</B>&nbsp;<SPAN Class="roman"><I>Environment_Task</I></SPAN>&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;(1)&nbsp;--<SPAN Class="roman"><I>&nbsp;The&nbsp;environment&nbsp;</I></SPAN><SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;(that&nbsp;is,&nbsp;the&nbsp;sequence&nbsp;of&nbsp;</I></SPAN><SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN><SPAN Class="roman"><I>s)&nbsp;goes&nbsp;here.</I></SPAN><BR>
<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;(2)&nbsp;--<SPAN Class="roman"><I>&nbsp;Call&nbsp;the&nbsp;main&nbsp;subprogram,&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</I></SPAN><BR>
<B>end</B>&nbsp;<SPAN Class="roman"><I>Environment_Task</I></SPAN>;</DIV>
<DIV Class="paranum">13</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><A NAME="I4043"></A>The 
environment <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN> 
at (1) is a sequence of <SPAN Class="swiss"><A HREF="RM-3-11.html#S0087">declarative_item</A></SPAN>s 
consisting of copies of the <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
included in the partition. The order of elaboration of <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
is the order in which they appear in the environment <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN>: 
</DIV>
<DIV Class="paranum">14</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The order of all included <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
is such that there are no forward elaboration dependences.&nbsp;</LI></UL>
<DIV Class="paranum">15</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>Any included <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0231">library_unit_declaration</A></SPAN> 
to which a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Elaborate_Body applies is immediately followed by its <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0233">library_unit_body</A></SPAN>, 
if included.&nbsp;</LI></UL>
<DIV Class="paranum">16</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>All <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
declared pure occur before any that are not declared pure.</LI></UL>
<DIV Class="paranum">17</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>All preelaborated <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
occur before any that are not preelaborated.&nbsp;</LI></UL>
<DIV Class="paranum">18</DIV>
<DIV Class="Normal">There shall be a total order of the <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
that obeys the above rules. The order is otherwise implementation defined. 
</DIV>
<DIV Class="paranum">19</DIV>
<DIV Class="Normal">The full expanded names of the library units and 
subunits included in a given partition shall be distinct.</DIV>
<DIV Class="paranum">20</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The <SPAN Class="swiss"><A HREF="RM-5-1.html#S0130">sequence_of_statements</A></SPAN> 
of the environment task (see (2) above) consists of either:&nbsp;</DIV>
<DIV Class="paranum">21</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>A call to the main subprogram, if 
the partition has one. If the main subprogram has parameters, they are 
passed; where the actuals come from is implementation defined. What happens 
to the result of a main function is also implementation defined.&nbsp;</LI></UL>
<DIV Class="paranum">22</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">or:&nbsp;</DIV>
<DIV Class="paranum">23</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>A <SPAN Class="swiss"><A HREF="RM-5-1.html#S0134">null_statement</A></SPAN>, 
if there is no main subprogram.&nbsp;</LI></UL>
<DIV Class="paranum">24</DIV>
<DIV Class="Normal">The mechanisms for building and running partitions 
are implementation defined. These might be combined into one operation, 
as, for example, in dynamic linking, or &ldquo;load-and-go&rdquo; systems. 
</DIV>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">25</DIV>
<DIV Class="Normal"><A NAME="I4044"></A>The execution of a program consists 
of the execution of a set of partitions. Further details are implementation 
defined. <A NAME="I4045"></A>The execution of a partition starts with 
the execution of its environment task, ends when the environment task 
terminates, and includes the executions of all tasks of the partition. 
The execution of the (implicit) <SPAN Class="swiss"><A HREF="RM-9-1.html#S0192">task_body</A></SPAN> 
of the environment task acts as a master for all other tasks created 
as part of the execution of the partition. When the environment task 
completes (normally or abnormally), it waits for the termination of all 
such tasks, and then finalizes any remaining objects of the partition. 
</DIV>

<H4 Class="centered">Bounded (Run-Time) Errors</H4>
<DIV Class="paranum">26</DIV>
<DIV Class="Normal"><A NAME="I4046"></A><A NAME="I4047"></A>Once the 
environment task has awaited the termination of all other tasks of the 
partition, any further attempt to create a task (during finalization) 
is a bounded error, and may result in the raising of Program_Error either 
upon creation or activation of the task. <A NAME="I4048"></A>If such 
a task is activated, it is not specified whether the task is awaited 
prior to termination of the environment task.&nbsp;</DIV>

<H4 Class="centered">Implementation Requirements</H4>
<DIV Class="paranum">27</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The implementation 
shall ensure that all compilation units included in a partition are consistent 
with one another, and are legal according to the rules of the language. 
</DIV>

<H4 Class="centered">Implementation Permissions</H4>
<DIV Class="paranum">28</DIV>
<DIV Class="Normal"><A NAME="I4049"></A>The kind of partition described 
in this clause is known as an <I>active</I> partition. An implementation 
is allowed to support other kinds of partitions, with implementation-defined 
semantics.&nbsp;</DIV>
<DIV Class="paranum">29</DIV>
<DIV Class="Normal">An implementation may restrict the kinds of subprograms 
it supports as main subprograms. However, an implementation is required 
to support all main subprograms that are public parameterless library 
procedures.&nbsp;</DIV>
<DIV Class="paranum">30</DIV>
<DIV Class="Normal">If the environment task completes abnormally, the 
implementation may abort any dependent tasks.&nbsp;</DIV>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">31</DIV>
<DIV Class="Notes">8&nbsp;&nbsp;An implementation may provide inter-partition 
communication mechanism(s) via special packages and pragmas. Standard 
pragmas for distribution and methods for specifying inter-partition communication 
are defined in <A HREF="RM-E.html">Annex E</A>, &ldquo;<A HREF="RM-E.html">Distributed 
Systems</A>&rdquo;. If no such mechanisms are provided, then each partition 
is isolated from all others, and behaves as a program in and of itself. 
</DIV>
<DIV Class="paranum">32</DIV>
<DIV Class="Notes">9&nbsp;&nbsp;Partitions are not required to run in 
separate address spaces. For example, an implementation might support 
dynamic linking via the partition concept.</DIV>
<DIV Class="paranum">33</DIV>
<DIV Class="Notes">10&nbsp;&nbsp;An order of elaboration of <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s 
that is consistent with the partial ordering defined above does not always 
ensure that each <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0233">library_unit_body</A></SPAN> 
is elaborated before any other compilation unit whose elaboration necessitates 
that the <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0233">library_unit_body</A></SPAN> 
be already elaborated. (In particular, there is no requirement that the 
body of a library unit be elaborated as soon as possible after the <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0231">library_unit_declaration</A></SPAN> 
is elaborated, unless the pragmas in subclause <A HREF="RM-10-2-1.html">10.2.1</A> 
are used.)</DIV>
<DIV Class="paranum">34</DIV>
<DIV Class="Notes">11&nbsp;&nbsp;A partition (active or otherwise) need 
not have a main subprogram. In such a case, all the work done by the 
partition would be done by elaboration of various <SPAN Class="swiss"><A HREF="RM-10-1-1.html#S0230">library_item</A></SPAN>s, 
and by tasks created by that elaboration. Passive partitions, which cannot 
have main subprograms, are defined in <A HREF="RM-E.html">Annex E</A>, 
&ldquo;<A HREF="RM-E.html">Distributed Systems</A>&rdquo;.&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-10-1-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-10-2-1.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
