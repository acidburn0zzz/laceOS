<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Task Execution - Task Activation</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>9.2 Task Execution - Task Activation</H1>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>execution (task)</I> 
[partial]}</SPAN> <A NAME="I3911"></A>The execution of a task of a given 
task type consists of the execution of the corresponding <SPAN Class="swiss"><A HREF="AA-9-1.html#S0192">task_body</A></SPAN>. 
<SPAN STYLE="font-size: 80%">{<I>execution (task_body)</I> [partial]}</SPAN> 
<A NAME="I3912"></A><SPAN STYLE="font-size: 80%">{<I>task (execution)</I>}</SPAN> 
<A NAME="I3913"></A><SPAN STYLE="font-size: 80%">{<I>activation (of a 
task)</I>}</SPAN> <A NAME="I3914"></A><SPAN STYLE="font-size: 80%">{<I>task 
(activation)</I>}</SPAN> <A NAME="I3915"></A>The initial part of this 
execution is called the <I>activation</I> of the task; it consists of 
the elaboration of the <SPAN Class="swiss"><A HREF="AA-3-11.html#S0086">declarative_part</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="AA-9-1.html#S0192">task_body</A></SPAN>. 
<SPAN STYLE="font-size: 80%">{<I>activation failure</I>}</SPAN> <A NAME="I3916"></A>Should 
an exception be propagated by the elaboration of its <SPAN Class="swiss"><A HREF="AA-3-11.html#S0086">declarative_part</A></SPAN>, 
the activation of the task is defined to have <I>failed</I>, and it becomes 
a completed task.</DIV>
<DIV Class="paranum">2/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
A task object (which represents one task) can be <SPAN class="insert2">a 
part of a stand-alone object, of an object created by</SPAN><SPAN class="delete2">&nbsp;created 
either as part of the elaboration of an <SPAN Class="swiss"><A HREF="AA-3-3-1.html#S0032">object_declaration</A></SPAN> 
occurring immediately within some declarative region, or as part of the 
evaluation of</SPAN> an <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN><SPAN class="insert2">, 
or of an anonymous object of a limited type, or a coextension of one 
of these</SPAN>. All tasks<SPAN class="insert2">&nbsp;that are part or coextensions 
of any of the stand-alone objects</SPAN> created by the elaboration of 
<SPAN Class="swiss"><A HREF="AA-3-3-1.html#S0032">object_declaration</A></SPAN>s<SPAN class="insert2">&nbsp;(or <SPAN Class="swiss"><A HREF="AA-12-3.html#S0259">generic_association</A></SPAN>s 
of formal objects of mode <B>in</B>)</SPAN> of a single declarative region<SPAN class="delete2">&nbsp;(including subcomponents of the declared objects)</SPAN> are activated 
together. <SPAN class="insert2">All tasks that are part or coextensions 
of a single object that is not a stand-alone object are activated together.</SPAN><SPAN class="delete2">&nbsp;Similarly, 
all tasks created by the evaluation of a single <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN> 
are activated together. The activation of a task is associated with the 
innermost <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-3-3-1.html#S0032">object_declaration</A></SPAN> 
that is responsible for its creation.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">2.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>The initialization of an 
<SPAN Class="swiss"><A HREF="AA-3-3-1.html#S0032">object_declaration</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN> 
can indirectly include the creation of other objects that contain tasks. 
For example, the default expression for a subcomponent of an object created 
by an <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN> 
might call a function that evaluates a completely different <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN>. 
Tasks created by the two allocators are <I>not</I> activated together. 
</DIV>
<DIV Class="paranum">3/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
For <SPAN class="insert2">the&nbsp;</SPAN>tasks<SPAN class="delete2">&nbsp;created 
by the elaboration of <SPAN Class="swiss"><A HREF="AA-3-3-1.html#S0032">object_declaration</A></SPAN>s</SPAN> 
of a given declarative region, the activations are initiated within the 
context of the <SPAN Class="swiss"><A HREF="AA-11-2.html#S0247">handled_sequence_of_statements</A></SPAN> 
(and its associated <SPAN Class="swiss"><A HREF="AA-11-2.html#S0248">exception_handler</A></SPAN>s 
if any &mdash; see <A HREF="AA-11-2.html">11.2</A>), just prior to executing 
the statements of the <SPAN class="insert2"><SPAN Class="swiss"><A HREF="AA-11-2.html#S0247">handled_sequence_of_statements</A></SPAN></SPAN><SPAN class="delete2"><SPAN Class="swiss">&nbsp;_sequence</SPAN></SPAN>. 
[For a package without an explicit body or an explicit <SPAN Class="swiss"><A HREF="AA-11-2.html#S0247">handled_sequence_of_statements</A></SPAN>, 
an implicit body or an implicit <SPAN Class="swiss"><A HREF="AA-5-1.html#S0134">null_statement</A></SPAN> 
is assumed, as defined in <A HREF="AA-7-2.html">7.2</A>.]&nbsp;</DIV>
<DIV Class="paranum">3.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>If Tasking_Error is raised, 
it can be handled by handlers of the <SPAN Class="swiss"><A HREF="AA-11-2.html#S0247">handled_sequence_of_statements</A></SPAN>. 
</DIV>
<DIV Class="paranum">4/2</DIV>
<DIV Class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
For tasks <SPAN class="insert2">that are part or coextensions of a single 
object that is not a stand-alone object, activations are initiated after 
completing any initialization of the outermost object enclosing these 
tasks, prior to performing any other operation on the outermost object. 
In particular, for tasks that are part or coextensions of the object 
</SPAN>created by the evaluation of an <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN>, 
the activations are initiated as the last step of evaluating the <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN>, 
<SPAN class="delete2">after completing any initialization for the object 
created by the <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN>, 
and&nbsp;</SPAN>prior to returning the new access value.<SPAN class="insert2">&nbsp;For tasks that are part or coextensions of an object that is the result 
of a function call, the activations are not initiated until after the 
function returns.</SPAN></DIV>
<DIV Class="paranum">4.a/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Discussion:&nbsp;</B></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
<SPAN class="insert2">The intent is that &ldquo;temporary&rdquo; objects 
with task parts (or coextensions) are treated similarly to an object 
created by an allocator. The &ldquo;whole&rdquo; object is initialized, 
and then all of the task parts (including the coextensions) are activated 
together. Each such &ldquo;whole&rdquo; object has its own task activation 
sequence, involving the activating task being suspended until all the 
new tasks complete their activation.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">5</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>activator (of a 
task)</I>}</SPAN> <A NAME="I3917"></A><SPAN STYLE="font-size: 80%">{<I>blocked 
(waiting for activations to complete)</I> [partial]}</SPAN> <A NAME="I3918"></A>The 
task that created the new tasks and initiated their activations (the 
<I>activator</I>) is blocked until all of these activations complete 
(successfully or not). <SPAN STYLE="font-size: 80%">{<I>Tasking_Error 
(raised by failure of run-time check)</I>}</SPAN> <A NAME="I3919"></A>Once 
all of these activations are complete, if the activation of any of the 
tasks has failed [(due to the propagation of an exception)], Tasking_Error 
is raised in the activator, at the place at which it initiated the activations. 
Otherwise, the activator proceeds with its execution normally. Any tasks 
that are aborted prior to completing their activation are ignored when 
determining whether to raise Tasking_Error.&nbsp;</DIV>
<DIV Class="paranum">5.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>Note that a task created 
by an <SPAN Class="swiss"><A HREF="AA-4-8.html#S0129">allocator</A></SPAN> 
does not necessarily depend on its activator; in such a case the activator's 
termination can precede the termination of the newly created task.&nbsp;</DIV>
<DIV Class="paranum">5.b</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>Tasking_Error is raised only 
once, even if two or more of the tasks being activated fail their activation. 
</DIV>
<DIV Class="paranum">5.c/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>To be honest:&nbsp;</B></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00265.TXT">AI95-00265-01</A></I>} 
<SPAN class="insert2">The pragma Partition_Elaboration_Policy (see <A HREF="AA-H-6.html">H.6</A>) 
can be used to defer task activation to a later point, thus changing 
many of these rules.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">6</DIV>
<DIV Class="Normal">Should the task that created the new tasks never 
reach the point where it would initiate the activations (due to an abort 
or the raising of an exception), the newly created tasks become terminated 
and are never activated.&nbsp;</DIV>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Notes">5&nbsp;&nbsp;An entry of a task can be called before 
the task has been activated.</DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="Notes">6&nbsp;&nbsp;If several tasks are activated together, 
the execution of any of these tasks need not await the end of the activation 
of the other tasks.</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Notes">7&nbsp;&nbsp;A task can become completed during its 
activation either because of an exception or because it is aborted (see 
<A HREF="AA-9-8.html">9.8</A>).</DIV>

<H4 Class="centered">Examples</H4>
<DIV Class="paranum">10</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><I>Example of task 
activation:</I>&nbsp;</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Examples"><B>procedure</B>&nbsp;P&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;A,&nbsp;B&nbsp;:&nbsp;Server;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;elaborate&nbsp;the&nbsp;task&nbsp;objects&nbsp;A,&nbsp;B</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Server;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;elaborate&nbsp;the&nbsp;task&nbsp;object&nbsp;C</I></SPAN><BR>
<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;the&nbsp;tasks&nbsp;A,&nbsp;B,&nbsp;C&nbsp;are&nbsp;activated&nbsp;together&nbsp;before&nbsp;the&nbsp;first&nbsp;statement</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;...<BR>
<B>end</B>;</DIV>

<H4 Class="centered">Wording Changes from Ada 83</H4>
<DIV Class="paranum">11.a</DIV>
<DIV Class="Annotations">We have replaced the term <I>suspended</I> with 
<I>blocked</I>, since we didn't want to consider a task blocked when 
it was simply competing for execution resources. &quot;Suspended&quot; 
is sometimes used more generally to refer to tasks that are not actually 
running on some processor, due to the lack of resources.</DIV>
<DIV Class="paranum">11.b</DIV>
<DIV Class="Annotations">This clause has been rewritten in an attempt 
to improve presentation.&nbsp;</DIV>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<DIV Class="paranum">11.c/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
<SPAN class="insert2">Adjusted the wording for activating tasks to handle 
the case of anonymous function return objects. This is critical; we don't 
want to be waiting for the tasks in a return object when we exit the 
function normally.</SPAN>&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
