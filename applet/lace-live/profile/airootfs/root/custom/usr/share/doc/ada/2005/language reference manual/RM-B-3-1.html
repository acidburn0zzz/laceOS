<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>The Package Interfaces.C.Strings</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.CodeIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.2em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    UL.CodeIndentedBulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 7.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    UL.CodeIndentedNestedBulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 9.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    UL.NotesBulleted {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-right: 2.5em; margin-top: 0em; margin-bottom: 0.5em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B></SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>B.3.1 The Package Interfaces.C.Strings</H1>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal">The package Interfaces.C.Strings declares types and 
subprograms allowing an Ada program to allocate, reference, update, and 
free C-style strings. In particular, the private type chars_ptr corresponds 
to a common use of &ldquo;char *&rdquo; in C programs, and an object 
of this type can be passed to a subprogram to which <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Import(C,...) has been applied, and for which &ldquo;char *&rdquo; is 
the type of the argument of the C function.&nbsp;</DIV>

<H4 Class="centered">Static Semantics</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The library package 
Interfaces.C.Strings has the following declaration:&nbsp;</DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="Examples"><B>package</B>&nbsp;Interfaces.C.Strings&nbsp;<B>is</B><A NAME="I6532"></A><BR>
&nbsp;&nbsp;&nbsp;<B>pragma</B>&nbsp;Preelaborate(Strings);</DIV>
<DIV Class="paranum">4</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I6533"></A>char_array_access&nbsp;<B>is</B>&nbsp;<B>access</B>&nbsp;<B>all</B>&nbsp;char_array;</DIV>
<DIV Class="paranum">5/2</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I6534"></A>chars_ptr&nbsp;<B>is</B>&nbsp;<B>private</B>;<BR>
&nbsp;&nbsp;&nbsp;<B>pragma</B>&nbsp;Preelaborable_Initialization(chars_ptr);</DIV>
<DIV Class="paranum">6/2</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I6535"></A>chars_ptr_array&nbsp;<B>is</B>&nbsp;<B>array</B>&nbsp;(size_t&nbsp;<B>range</B>&nbsp;&lt;&gt;)&nbsp;<B>of</B>&nbsp;<B>aliased</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I6536"></A>Null_Ptr&nbsp;:&nbsp;<B>constant</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6537"></A>To_Chars_Ptr&nbsp;(Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array_access;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nul_Check&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;False)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6538"></A>New_Char_Array&nbsp;(Chars&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array)&nbsp;<B>return</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">10</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6539"></A>New_String&nbsp;(Str&nbsp;:&nbsp;<B>in</B>&nbsp;String)&nbsp;<B>return</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I6540"></A>Free&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;<B>out</B>&nbsp;chars_ptr);</DIV>
<DIV Class="paranum">12</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I6541"></A>Dereference_Error&nbsp;:&nbsp;<B>exception</B>;</DIV>
<DIV Class="paranum">13</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6542"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;char_array;</DIV>
<DIV Class="paranum">14</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6543"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;char_array;</DIV>
<DIV Class="paranum">15</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6544"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;String;</DIV>
<DIV Class="paranum">16</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6545"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;String;</DIV>
<DIV Class="paranum">17</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6546"></A>Strlen&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;size_t;</DIV>
<DIV Class="paranum">18</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I6547"></A>Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chars&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;True);</DIV>
<DIV Class="paranum">19</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I6548"></A>Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Str&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;String;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;True);</DIV>
<DIV Class="paranum">20</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I6549"></A>Update_Error&nbsp;:&nbsp;<B>exception</B>;</DIV>
<DIV Class="paranum">21</DIV>
<DIV Class="Examples"><B>private</B><BR>
&nbsp;&nbsp;&nbsp;...&nbsp;--&nbsp;<SPAN Class="roman"><I>not&nbsp;specified&nbsp;by&nbsp;the&nbsp;language</I></SPAN><BR>
<B>end</B>&nbsp;Interfaces.C.Strings;</DIV>
<DIV Class="paranum">22</DIV>
<DIV Class="Normal">The type chars_ptr is C-compatible and corresponds 
to the use of C's &ldquo;char *&rdquo; for a pointer to the first char 
in a char array terminated by nul. When an object of type chars_ptr is 
declared, its value is by default set to Null_Ptr, unless the object 
is imported (see <A HREF="RM-B-1.html">B.1</A>).&nbsp;</DIV>
<DIV Class="paranum">23</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;To_Chars_Ptr&nbsp;(Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array_access;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nul_Check&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;False)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">24/1</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">If Item is <B>null</B>, 
then To_Chars_Ptr returns Null_Ptr. If Item is not <B>null</B>, Nul_Check 
is True, and Item.<B>all</B> does not contain nul, then the function 
propagates Terminator_Error; otherwise To_Chars_Ptr performs a pointer 
conversion with no allocation of memory.</DIV>
<DIV Class="paranum">25</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;New_Char_Array&nbsp;(Chars&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array)&nbsp;<B>return</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">26</DIV>
<DIV Class="CodeIndented">This function returns a pointer to an allocated 
object initialized to Chars(Chars'First .. Index) &amp; nul, where&nbsp;</DIV>
<DIV Class="paranum">27</DIV>
<UL Class="CodeIndentedBulleted"><LI TYPE=DISC>Index = Chars'Last if 
Chars does not contain nul, or</LI></UL>
<DIV Class="paranum">28</DIV>
<UL Class="CodeIndentedBulleted"><LI TYPE=DISC>Index is the smallest 
size_t value I such that Chars(I+1) = nul.&nbsp;</LI></UL>
<DIV Class="paranum">28.1</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">Storage_Error 
is propagated if the allocation fails.</DIV>
<DIV Class="paranum">29</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;New_String&nbsp;(Str&nbsp;:&nbsp;<B>in</B>&nbsp;String)&nbsp;<B>return</B>&nbsp;chars_ptr;</DIV>
<DIV Class="paranum">30</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">This function 
is equivalent to New_Char_Array(To_C(Str)).</DIV>
<DIV Class="paranum">31</DIV>
<DIV Class="Examples"><B>procedure</B>&nbsp;Free&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;<B>out</B>&nbsp;chars_ptr);</DIV>
<DIV Class="paranum">32</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">If Item is Null_Ptr, 
then Free has no effect. Otherwise, Free releases the storage occupied 
by Value(Item), and resets Item to Null_Ptr.</DIV>
<DIV Class="paranum">33</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;char_array;</DIV>
<DIV Class="paranum">34</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">If Item = Null_Ptr 
then Value propagates Dereference_Error. Otherwise Value returns the 
prefix of the array of chars pointed to by Item, up to and including 
the first nul. The lower bound of the result is 0. If Item does not point 
to a nul-terminated string, then execution of Value is erroneous.</DIV>
<DIV Class="paranum">35</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;char_array;</DIV>
<DIV Class="paranum">36/1</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">If Item = Null_Ptr 
then Value propagates Dereference_Error. Otherwise Value returns the 
shorter of two arrays, either the first Length chars pointed to by Item, 
or Value(Item). The lower bound of the result is 0. If Length is 0, then 
Value propagates Constraint_Error.&nbsp;</DIV>
<DIV Class="paranum">37</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;String;</DIV>
<DIV Class="paranum">38</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">Equivalent to 
To_Ada(Value(Item), Trim_Nul=&gt;True).</DIV>
<DIV Class="paranum">39</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;String;</DIV>
<DIV Class="paranum">40/1</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">Equivalent to 
To_Ada(Value(Item, Length) &amp; nul, Trim_Nul=&gt;True).</DIV>
<DIV Class="paranum">41</DIV>
<DIV Class="Examples"><B>function</B>&nbsp;Strlen&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;size_t;</DIV>
<DIV Class="paranum">42</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.9em">Returns <I>Val</I>'Length&ndash;1 
where <I>Val</I> = Value(Item); propagates Dereference_Error if Item 
= Null_Ptr.&nbsp;</DIV>
<DIV Class="paranum">43</DIV>
<DIV Class="Examples"><B>procedure</B>&nbsp;Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chars&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;Boolean&nbsp;:=&nbsp;True);</DIV>
<DIV Class="paranum">44/1</DIV>
<DIV Class="CodeIndented" Style="margin-bottom: 0.4em">If Item = Null_Ptr, 
then Update propagates Dereference_Error. Otherwise, this procedure updates 
the value pointed to by Item, starting at position Offset, using Chars 
as the data to be copied into the array. Overwriting the nul terminator, 
and skipping with the Offset past the nul terminator, are both prevented 
if Check is True, as follows:&nbsp;</DIV>
<DIV Class="paranum">45</DIV>
<UL Class="CodeIndentedBulleted"><LI TYPE=DISC>Let N = Strlen(Item). 
If Check is True, then:&nbsp;</LI></UL>
<DIV Class="paranum">46</DIV>
<UL Class="CodeIndentedNestedBulleted"><LI TYPE=DISC>If Offset+Chars'Length&gt;N, 
propagate Update_Error.</LI></UL>
<DIV Class="paranum">47</DIV>
<UL Class="CodeIndentedNestedBulleted"><LI TYPE=DISC>Otherwise, overwrite 
the data in the array pointed to by Item, starting at the char at position 
Offset, with the data in Chars.&nbsp;</LI></UL>
<DIV Class="paranum">48</DIV>
<UL Class="CodeIndentedBulleted" Style="margin-bottom: 0.7em"><LI TYPE=DISC>If 
Check is False, then processing is as above, but with no check that Offset+Chars'Length&gt;N. 
</LI></UL>
<DIV Class="paranum">49</DIV>
<DIV Class="Examples"><B>procedure</B>&nbsp;Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Str&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;String;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;True);</DIV>
<DIV Class="paranum">50/2</DIV>
<DIV Class="CodeIndented">Equivalent to Update(Item, Offset, To_C(Str, 
Append_Nul =&gt; False), Check).&nbsp;</DIV>

<H4 Class="centered">Erroneous Execution</H4>
<DIV Class="paranum">51</DIV>
<DIV Class="Normal"><A NAME="I6550"></A>Execution of any of the following 
is erroneous if the Item parameter is not null_ptr and Item does not 
point to a nul-terminated array of chars.&nbsp;</DIV>
<DIV Class="paranum">52</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>a Value function not taking a Length 
parameter,</LI></UL>
<DIV Class="paranum">53</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>the Free procedure,</LI></UL>
<DIV Class="paranum">54</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>the Strlen function.&nbsp;</LI></UL>
<DIV Class="paranum">55</DIV>
<DIV Class="Normal"><A NAME="I6551"></A>Execution of Free(X) is also 
erroneous if the chars_ptr X was not returned by New_Char_Array or New_String.</DIV>
<DIV Class="paranum">56</DIV>
<DIV Class="Normal"><A NAME="I6552"></A>Reading or updating a freed char_array 
is erroneous.</DIV>
<DIV Class="paranum">57</DIV>
<DIV Class="Normal"><A NAME="I6553"></A>Execution of Update is erroneous 
if Check is False and a call with Check equal to True would have propagated 
Update_Error.&nbsp;</DIV>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">58</DIV>
<DIV Class="Notes">11&nbsp;&nbsp;New_Char_Array and New_String might 
be implemented either through the allocation function from the C environment 
(&ldquo;malloc&rdquo;) or through Ada dynamic memory allocation (&ldquo;new&rdquo;). 
The key points are&nbsp;</DIV>
<DIV Class="paranum">59</DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC>the returned value (a chars_ptr) 
is represented as a C &ldquo;char *&rdquo; so that it may be passed to 
C functions;</LI></UL>
<DIV Class="paranum">60</DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC>the allocated object should be 
freed by the programmer via a call of Free, not by a called C function. 
</LI></UL>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
