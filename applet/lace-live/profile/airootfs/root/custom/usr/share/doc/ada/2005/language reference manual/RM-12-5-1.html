<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Formal Private and Derived Types</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.SyntaxIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.4em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    UL.NotesBulleted {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-right: 2.5em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Hanging-Body {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 7.2em; margin-top: 0em; margin-bottom: 0.6em}
    DIV.Hanging-Term {float: left; font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-top: 0em; margin-bottom: 0em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B></SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-12-5.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-12-5-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>12.5.1 Formal Private and Derived Types</H1>
<DIV Class="paranum">1/2</DIV>
<DIV Class="Normal">In its most general form, the category determined 
for a formal private type is all types, but it can be restricted to only 
nonlimited types or to only tagged types. The category determined for 
a formal derived type is the derivation class rooted at the ancestor 
type.&nbsp;</DIV>

<H4 Class="centered">Syntax</H4>
<DIV Class="paranum">2</DIV>
<DIV Class="SyntaxIndented"><SPAN Class="swiss">formal_private_type_definition</SPAN><A NAME="I4350"></A><A NAME="S0264"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN>[[<B>abstract</B>]&nbsp;<B>tagged</B>]&nbsp;[<B>limited</B>]&nbsp;<B>private</B></DIV>
<DIV Class="paranum">3/2</DIV>
<DIV Class="SyntaxIndented"><SPAN Class="swiss">formal_derived_type_definition</SPAN><A NAME="I4351"></A><A NAME="S0265"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<B>abstract</B>]&nbsp;[<B>limited</B>&nbsp;|&nbsp;<B>synchronized</B>]&nbsp;<B>new</B>&nbsp;<A NAME="I4352"></A><SPAN Class="swiss"><A HREF="RM-3-2-2.html#S0028">subtype_mark</A></SPAN>&nbsp;[[<B>and</B>&nbsp;<A NAME="I4353"></A><SPAN Class="swiss"><A HREF="RM-3-9-4.html#S0078">interface_list</A></SPAN>]<B>with</B>&nbsp;<B>private</B>]</DIV>

<H4 Class="centered">Legality Rules</H4>
<DIV Class="paranum">4</DIV>
<DIV Class="Normal">If a generic formal type declaration has a <SPAN Class="swiss"><A HREF="RM-3-7.html#S0061">known_discriminant_part</A></SPAN>, 
then it shall not include a <SPAN Class="swiss"><A HREF="RM-3-7.html#S0063">default_expression</A></SPAN> 
for a discriminant.&nbsp;</DIV>
<DIV Class="paranum">5/2</DIV>
<DIV Class="Normal"><A NAME="I4354"></A><A NAME="I4355"></A>The <I>ancestor 
subtype</I> of a formal derived type is the subtype denoted by the <SPAN Class="swiss"><A HREF="RM-3-2-2.html#S0028">subtype_mark</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="RM-12-5-1.html#S0265">formal_derived_type_definition</A></SPAN>. 
For a formal derived type declaration, the reserved words <B>with private</B> 
shall appear if and only if the ancestor type is a tagged type; in this 
case the formal derived type is a private extension of the ancestor type 
and the ancestor shall not be a class-wide type. Similarly, an <SPAN Class="swiss"><A HREF="RM-3-9-4.html#S0078">interface_list</A></SPAN> 
or the optional reserved words <B>abstract</B> or <B>synchronized</B> 
shall appear only if the ancestor type is a tagged type. The reserved 
word <B>limited</B> or <B>synchronized</B> shall appear only if the ancestor 
type and any progenitor types are limited types. The reserved word <B>synchronized</B> 
shall appear (rather than <B>limited</B>) if the ancestor type or any 
of the progenitor types are synchronized interfaces.</DIV>
<DIV Class="paranum">5.1/2</DIV>
<DIV Class="Normal">&nbsp;&nbsp;The actual type for a formal derived type shall 
be a descendant of the ancestor type and every progenitor of the formal 
type. If the reserved word <B>synchronized</B> appears in the declaration 
of the formal derived type, the actual type shall be a synchronized tagged 
type.&nbsp;</DIV>
<DIV Class="paranum">6</DIV>
<DIV Class="Normal">If the formal subtype is definite, then the actual 
subtype shall also be definite.&nbsp;</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">For a generic formal 
derived type with no <SPAN Class="swiss"><A HREF="RM-3-7.html#S0059">discriminant_part</A></SPAN>: 
</DIV>
<DIV Class="paranum">8</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If the ancestor subtype is constrained, 
the actual subtype shall be constrained, and shall be statically compatible 
with the ancestor;&nbsp;</LI></UL>
<DIV Class="paranum">9</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If the ancestor subtype is an unconstrained 
access or composite subtype, the actual subtype shall be unconstrained. 
</LI></UL>
<DIV Class="paranum">10</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If the ancestor subtype is an unconstrained 
discriminated subtype, then the actual shall have the same number of 
discriminants, and each discriminant of the actual shall correspond to 
a discriminant of the ancestor, in the sense of <A HREF="RM-3-7.html">3.7</A>.</LI></UL>
<DIV Class="paranum">10.1/2</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If the ancestor subtype is an access 
subtype, the actual subtype shall exclude null if and only if the ancestor 
subtype excludes null.&nbsp;</LI></UL>
<DIV Class="paranum">11</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The declaration of 
a formal derived type shall not have a <SPAN Class="swiss"><A HREF="RM-3-7.html#S0061">known_discriminant_part</A></SPAN>. 
For a generic formal private type with a <SPAN Class="swiss"><A HREF="RM-3-7.html#S0061">known_discriminant_part</A></SPAN>: 
</DIV>
<DIV Class="paranum">12</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The actual type shall be a type with 
the same number of discriminants.</LI></UL>
<DIV Class="paranum">13</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The actual subtype shall be unconstrained.</LI></UL>
<DIV Class="paranum">14</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The subtype of each discriminant of 
the actual type shall statically match the subtype of the corresponding 
discriminant of the formal type. <A NAME="I4356"></A></LI></UL>
<DIV Class="paranum">15</DIV>
<DIV Class="Normal">For a generic formal type with an <SPAN Class="swiss"><A HREF="RM-3-7.html#S0060">unknown_discriminant_part</A></SPAN>, 
the actual may, but need not, have discriminants, and may be definite 
or indefinite.</DIV>

<H4 Class="centered">Static Semantics</H4>
<DIV Class="paranum">16/2</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;The category determined 
for a formal private type is as follows:&nbsp;</DIV>
<DIV Class="paranum">17/2</DIV>
<DIV Class="SyntaxIndented"><I>Type&nbsp;Definition</I>&nbsp;&nbsp;<I>Determined&nbsp;Category</I><BR>
<BR>
<B>limited&nbsp;private</B>&nbsp;&nbsp;the&nbsp;category&nbsp;of&nbsp;all&nbsp;types<BR>
<B>private</B>&nbsp;&nbsp;the&nbsp;category&nbsp;of&nbsp;all&nbsp;nonlimited&nbsp;types<BR>
<B>tagged&nbsp;limited&nbsp;private</B>&nbsp;&nbsp;the&nbsp;category&nbsp;of&nbsp;all&nbsp;tagged&nbsp;types<BR>
<B>tagged&nbsp;private</B>&nbsp;&nbsp;the&nbsp;category&nbsp;of&nbsp;all&nbsp;nonlimited&nbsp;tagged&nbsp;types</DIV>
<DIV Class="paranum">18</DIV>
<DIV Class="Normal">The presence of the reserved word <B>abstract</B> 
determines whether the actual type may be abstract.</DIV>
<DIV Class="paranum">19</DIV>
<DIV Class="Normal">A formal private or derived type is a private or 
derived type, respectively. A formal derived tagged type is a private 
extension. A formal private or derived type is abstract if the reserved 
word <B>abstract</B> appears in its declaration.</DIV>
<DIV Class="paranum">20/2</DIV>
<DIV Class="Normal">&nbsp;If the ancestor type is a composite type that is 
not an array type, the formal type inherits components from the ancestor 
type (including discriminants if a new <SPAN Class="swiss"><A HREF="RM-3-7.html#S0059">discriminant_part</A></SPAN> 
is not specified), as for a derived type defined by a <SPAN Class="swiss"><A HREF="RM-3-4.html#S0035">derived_type_definition</A></SPAN> 
(see <A HREF="RM-3-4.html">3.4</A> and <A HREF="RM-7-3-1.html">7.3.1</A>).</DIV>
<DIV Class="paranum">21/2</DIV>
<DIV Class="Normal">&nbsp;For a formal derived type, the predefined operators 
and inherited user-defined subprograms are determined by the ancestor 
type and any progenitor types, and are implicitly declared at the earliest 
place, if any, immediately within the declarative region in which the 
formal type is declared, where the corresponding primitive subprogram 
of the ancestor or progenitor is visible (see <A HREF="RM-7-3-1.html">7.3.1</A>). 
In an instance, the copy of such an implicit declaration declares a view 
of the corresponding primitive subprogram of the ancestor or progenitor 
of the formal derived type, even if this primitive has been overridden 
for the actual type. When the ancestor or progenitor of the formal derived 
type is itself a formal type, the copy of the implicit declaration declares 
a view of the corresponding copied operation of the ancestor or progenitor. 
In the case of a formal private extension, however, the tag of the formal 
type is that of the actual type, so if the tag in a call is statically 
determined to be that of the formal type, the body executed will be that 
corresponding to the actual type.&nbsp;</DIV>
<DIV Class="paranum">22/1</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;For a <SPAN Class="swiss"><A HREF="RM-4-1.html#S0093">prefix</A></SPAN> 
S that denotes a formal indefinite subtype, the following attribute is 
defined:&nbsp;</DIV>
<DIV Class="paranum">23</DIV>
<DIV Class="Hanging-Term">S'Definite</DIV><DIV Class="Hanging-Body">
<A NAME="I4357"></A><A NAME="I4358"></A>S'Definite yields True if the 
actual subtype corresponding to S is definite; otherwise it yields False. 
The value of this attribute is of the predefined type Boolean.&nbsp;</DIV>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">23.1/2</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;&nbsp;&nbsp;In the case where 
a formal type is tagged with unknown discriminants, and the actual type 
is a class-wide type <I>T</I>'Class:</DIV>
<DIV Class="paranum">23.2/2</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>For the purposes of defining the primitive 
operations of the formal type, each of the primitive operations of the 
actual type is considered to be a subprogram (with an intrinsic calling 
convention &mdash; see <A HREF="RM-6-3-1.html">6.3.1</A>) whose body 
consists of a dispatching call upon the corresponding operation of <I>T</I>, 
with its formal parameters as the actual parameters. If it is a function, 
the result of the dispatching call is returned.</LI></UL>
<DIV Class="paranum">23.3/2</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>If the corresponding operation of 
<I>T</I> has no controlling formal parameters, then the controlling tag 
value is determined by the context of the call, according to the rules 
for tag-indeterminate calls (see <A HREF="RM-3-9-2.html">3.9.2</A> and 
<A HREF="RM-5-2.html">5.2</A>). In the case where the tag would be statically 
determined to be that of the formal type, the call raises Program_Error. 
If such a function is renamed, any call on the renaming raises Program_Error. 
<A NAME="I4359"></A></LI></UL>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">24/2</DIV>
<DIV Class="Notes" Style="margin-bottom: 0.4em">9&nbsp;&nbsp;In accordance 
with the general rule that the actual type shall belong to the category 
determined for the formal (see <A HREF="RM-12-5.html">12.5</A>, &ldquo;<A HREF="RM-12-5.html">Formal 
Types</A>&rdquo;):&nbsp;</DIV>
<DIV Class="paranum">25</DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC>If the formal type is nonlimited, 
then so shall be the actual;</LI></UL>
<DIV Class="paranum">26</DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC>For a formal derived type, the 
actual shall be in the class rooted at the ancestor subtype.&nbsp;</LI></UL>
<DIV Class="paranum">27</DIV>
<DIV Class="Notes">10&nbsp;&nbsp;The actual type can be abstract only 
if the formal type is abstract (see <A HREF="RM-3-9-3.html">3.9.3</A>). 
</DIV>
<DIV Class="paranum">28</DIV>
<DIV Class="Notes">11&nbsp;&nbsp;If the formal has a <SPAN Class="swiss"><A HREF="RM-3-7.html#S0059">discriminant_part</A></SPAN>, 
the actual can be either definite or indefinite. Otherwise, the actual 
has to be definite.&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-12-5.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-12-5-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
