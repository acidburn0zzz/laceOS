<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Interfacing Pragmas</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert1 {text-decoration: underline; color: rgb(0,51,51) }
    SPAN.delete1 {text-decoration: line-through; color: rgb(0,51,51) }
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.SyntaxIndented {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.4em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    UL.NestedBulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-B.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-B-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>B.1 Interfacing Pragmas</H1>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal">A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import is used to import an entity defined in a foreign language into 
an Ada program, thus allowing a foreign-language subprogram to be called 
from Ada, or a foreign-language variable to be accessed from Ada. In 
contrast, a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Export is used to export an Ada entity to a foreign language, thus allowing 
an Ada subprogram to be called from a foreign language, or an Ada object 
to be accessed from a foreign language. The <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
Import and Export are intended primarily for objects and subprograms, 
although implementations are allowed to support other entities.</DIV>
<DIV Class="paranum">2</DIV>
<DIV Class="Normal">A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Convention is used to specify that an Ada entity should use the conventions 
of another language. It is intended primarily for types and &ldquo;callback&rdquo; 
subprograms. For example, &ldquo;<B>pragma</B> Convention(Fortran, Matrix);&rdquo; 
implies that Matrix should be represented according to the conventions 
of the supported Fortran implementation, namely column-major order.</DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="Normal">A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Linker_Options is used to specify the system linker parameters needed 
when a given compilation unit is included in a partition.</DIV>

<H4 Class="centered">Syntax</H4>
<DIV Class="paranum">4</DIV>
<DIV Class="SyntaxIndented" Style="margin-bottom: 0.2em"><SPAN STYLE="font-size: 80%">{<I>interfacing 
pragma</I> [distributed]}</SPAN> <A NAME="I6994"></A><SPAN STYLE="font-size: 80%">{<I>interfacing 
pragma (Import)</I> [partial]}</SPAN> <A NAME="I6995"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
interfacing (Import)</I> [partial]}</SPAN> <A NAME="I6996"></A><SPAN STYLE="font-size: 80%">{<I>interfacing 
pragma (Export)</I> [partial]}</SPAN> <A NAME="I6997"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
interfacing (Export)</I> [partial]}</SPAN> <A NAME="I6998"></A><SPAN STYLE="font-size: 80%">{<I>interfacing 
pragma (Convention)</I> [partial]}</SPAN> <A NAME="I6999"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
interfacing (Convention)</I> [partial]}</SPAN> <A NAME="I7000"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
interfacing (Linker_Options)</I> [partial]}</SPAN> <A NAME="I7001"></A>An 
<I>interfacing pragma</I> is a representation <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
that is one of the <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
Import, Export, or Convention. Their forms, together with that of the 
related <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Linker_Options, are as follows:&nbsp;</DIV>
<DIV Class="paranum">5</DIV>
<DIV Class="SyntaxIndented">&nbsp;&nbsp;<B>pragma</B> <A NAME="I7002"></A><A NAME="I7003"></A>Import(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Convention =&gt;] <I>convention_</I><A NAME="I7004"></A><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN>, 
[Entity =&gt;] <A NAME="I7005"></A><SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN><BR>
&nbsp;&nbsp;[, [External_Name =&gt;] <I>string_</I><A NAME="I7006"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN>] 
[, [Link_Name =&gt;] <I>string_</I><A NAME="I7007"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN>]);</DIV>
<DIV Class="paranum">6</DIV>
<DIV Class="SyntaxIndented">&nbsp;&nbsp;<B>pragma</B> <A NAME="I7008"></A><A NAME="I7009"></A>Export(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Convention =&gt;] <I>convention_</I><A NAME="I7010"></A><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN>, 
[Entity =&gt;] <A NAME="I7011"></A><SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN><BR>
&nbsp;&nbsp;[, [External_Name =&gt;] <I>string_</I><A NAME="I7012"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN>] 
[, [Link_Name =&gt;] <I>string_</I><A NAME="I7013"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN>]);</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="SyntaxIndented">&nbsp;&nbsp;<B>pragma</B> <A NAME="I7014"></A><A NAME="I7015"></A>Convention([Convention 
=&gt;] <I>convention_</I><A NAME="I7016"></A><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN>,[Entity 
=&gt;] <A NAME="I7017"></A><SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN>);</DIV>
<DIV Class="paranum">8</DIV>
<DIV Class="SyntaxIndented">&nbsp;&nbsp;<B>pragma</B> <A NAME="I7018"></A><A NAME="I7019"></A>Linker_Options(<I>string_</I><A NAME="I7020"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN>);</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="SyntaxIndented">A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Linker_Options is allowed only at the place of a <SPAN Class="swiss"><A HREF="AA-3-11.html#S0087">declarative_item</A></SPAN>.</DIV>
<DIV Class="paranum">9.1/1</DIV>
<DIV Class="SyntaxIndented">{<I><A HREF="defect1.html#8652/0058">8652/0058</A></I>} 
<SPAN class="insert1"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00036.TXT">AI95-00036-01</A></I>} 
<SPAN class="insert1">For <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
Import and Export, the argument for Link_Name shall not be given without 
the <I>pragma_argument_</I><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN> 
unless the argument for External_Name is given.</SPAN>&nbsp;</DIV>

<H4 Class="centered">Name Resolution Rules</H4>
<DIV Class="paranum">10</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>expected type (link 
name)</I> [partial]}</SPAN> <A NAME="I7021"></A>The expected type for 
a <I>string_</I><A NAME="I7022"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN> 
in an interfacing pragma or in pragma Linker_Options is String.&nbsp;</DIV>
<DIV Class="paranum">10.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>There is no language-defined 
support for external or link names of type Wide_String, or of other string 
types. Implementations may, of course, have additional pragmas for that 
purpose. Note that allowing both String and Wide_String in the same <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
would cause ambiguities.&nbsp;</DIV>

<H4 Class="centered">Legality Rules</H4>
<DIV Class="paranum">11</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>convention</I>}</SPAN> 
<A NAME="I7023"></A>The <I>convention_</I><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN> 
of an interfacing pragma shall be the name of a <I>convention</I>. The 
convention names are implementation defined, except for certain language-defined 
ones, such as Ada and Intrinsic, as explained in <A HREF="AA-6-3-1.html">6.3.1</A>, 
&ldquo;<A HREF="AA-6-3-1.html">Conformance Rules</A>&rdquo;. [Additional 
convention names generally represent the calling conventions of foreign 
languages, language implementations, or specific run-time models.] <SPAN STYLE="font-size: 80%">{<I>calling 
convention</I>}</SPAN> <A NAME="I7024"></A>The convention of a callable 
entity is its <I>calling convention</I>.&nbsp;</DIV>
<DIV Class="paranum">11.a</DIV>
<DIV Class="Annotations"><B>Implementation defined:&nbsp;</B>Implementation-defined 
convention names.</DIV>
<DIV Class="paranum">11.b</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>We considered representing 
the convention names using an enumeration type declared in System. Then, 
<I>convention_</I><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN> 
would be changed to <I>convention_</I><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN>, 
and we would make its expected type be the enumeration type. We didn't 
do this because it seems to introduce extra complexity, and because the 
list of available languages is better represented as the list of children 
of package Interfaces &mdash; a more open-ended sort of list.&nbsp;</DIV>
<DIV Class="paranum">12</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><SPAN STYLE="font-size: 80%">{<I>compatible 
(a type, with a convention)</I>}</SPAN> <A NAME="I7025"></A>If <I>L</I> 
is a <I>convention_</I><SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN> 
for a language, then a type T is said to be <I>compatible with convention 
L</I>, (alternatively, is said to be an <I>L-compatible type</I>) if 
any of the following conditions are met:&nbsp;</DIV>
<DIV Class="paranum">13</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>T is declared in a language interface 
package corresponding to <I>L</I> and is defined to be <I>L</I>-compatible 
(see <A HREF="AA-B-3.html">B.3</A>, <A HREF="AA-B-3-1.html">B.3.1</A>, 
<A HREF="AA-B-3-2.html">B.3.2</A>, <A HREF="AA-B-4.html">B.4</A>, <A HREF="AA-B-5.html">B.5</A>),</LI></UL>
<DIV Class="paranum">14</DIV>
<UL Class="Bulleted" Style="margin-bottom: 0.3em"><LI TYPE=DISC><SPAN STYLE="font-size: 80%">{<I>eligible 
(a type, for a convention)</I>}</SPAN> <A NAME="I7026"></A>Convention 
<I>L</I> has been specified for T in a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Convention, and T is <I>eligible for convention L</I>; that is:&nbsp;</LI></UL>
<DIV Class="paranum">15</DIV>
<UL Class="NestedBulleted"><LI TYPE=DISC>T is an array type with either 
an unconstrained or statically-constrained first subtype, and its component 
type is <I>L</I>-compatible,</LI></UL>
<DIV Class="paranum">16</DIV>
<UL Class="NestedBulleted"><LI TYPE=DISC>T is a record type that has 
no discriminants and that only has components with statically-constrained 
subtypes, and each component type is <I>L</I>-compatible,</LI></UL>
<DIV Class="paranum">17</DIV>
<UL Class="NestedBulleted"><LI TYPE=DISC>T is an access-to-object type, 
and its designated type is <I>L</I>-compatible,</LI></UL>
<DIV Class="paranum">18</DIV>
<UL Class="NestedBulleted"><LI TYPE=DISC>T is an access-to-subprogram 
type, and its designated profile's parameter and result types are all 
<I>L</I>-compatible.&nbsp;</LI></UL>
<DIV Class="paranum">19</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>T is derived from an <I>L</I>-compatible 
type,</LI></UL>
<DIV Class="paranum">20</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The implementation permits T as an 
<I>L</I>-compatible type.&nbsp;</LI></UL>
<DIV Class="paranum">20.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>For example, an implementation 
might permit Integer as a C-compatible type, though the C type to which 
it corresponds might be different in different environments.</DIV>
<DIV Class="paranum">21</DIV>
<DIV Class="Normal">If <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Convention applies to a type, then the type shall either be compatible 
with or eligible for the convention specified in the pragma.&nbsp;</DIV>
<DIV Class="paranum">21.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>If a type is derived from 
an <I>L</I>-compatible type, the derived type is by default <I>L</I>-compatible, 
but it is also permitted to specify pragma Convention for the derived 
type.</DIV>
<DIV Class="paranum">21.b</DIV>
<DIV Class="Annotations">It is permitted to specify pragma Convention 
for an incomplete type, but in the complete declaration each component 
must be <I>L</I>-compatible.</DIV>
<DIV Class="paranum">21.c</DIV>
<DIV Class="Annotations">If each component of a record type is <I>L</I>-compatible, 
then the record type itself is only <I>L</I>-compatible if it has a pragma 
Convention.&nbsp;</DIV>
<DIV Class="paranum">22</DIV>
<DIV Class="Normal">A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import shall be the completion of a declaration. <SPAN STYLE="font-size: 80%">{<I>notwithstanding</I>}</SPAN> 
<A NAME="I7027"></A>Notwithstanding any rule to the contrary, a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import may serve as the completion of any kind of (explicit) declaration 
if supported by an implementation for that kind of declaration. If a 
completion is a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import, then it shall appear in the same <SPAN Class="swiss"><A HREF="AA-3-11.html#S0086">declarative_part</A></SPAN>, 
<SPAN Class="swiss"><A HREF="AA-7-1.html#S0174">package_specification</A></SPAN>, 
<SPAN Class="swiss"><A HREF="AA-9-1.html#S0190">task_definition</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-9-4.html#S0195">protected_definition</A></SPAN> 
as the declaration. For a library unit, it shall appear in the same <SPAN Class="swiss"><A HREF="AA-10-1-1.html#S0228">compilation</A></SPAN>, 
before any subsequent <SPAN Class="swiss"><A HREF="AA-10-1-1.html#S0229">compilation_unit</A></SPAN>s 
other than <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s. 
If the <SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN> 
denotes more than one entity, then the <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import is the completion of all of them.&nbsp;</DIV>
<DIV Class="paranum">22.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>For declarations of deferred 
constants and subprograms, we mention pragma Import explicitly as a possible 
completion. For other declarations that require completions, we ignore 
the possibility of pragma Import. Nevertheless, if an implementation 
chooses to allow a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import to complete the declaration of a task, protected type, incomplete 
type, private type, etc., it may do so, and the normal completion is 
then not allowed for that declaration.&nbsp;</DIV>
<DIV Class="paranum">23</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>imported entity</I>}</SPAN> 
<A NAME="I7028"></A> <SPAN STYLE="font-size: 80%">{<I>exported entity</I>}</SPAN> 
<A NAME="I7029"></A>An entity specified as the Entity argument to a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import (or <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Export) is said to be <I>imported</I> (respectively, <I>exported</I>).</DIV>
<DIV Class="paranum">24</DIV>
<DIV Class="Normal">The declaration of an imported object shall not include 
an explicit initialization expression. [Default initializations are not 
performed.]&nbsp;</DIV>
<DIV Class="paranum">24.a</DIV>
<DIV Class="Annotations"><B>Proof:&nbsp;</B>This follows from the &ldquo;Notwithstanding 
...&rdquo; wording in the Dynamics Semantics paragraphs below.&nbsp;</DIV>
<DIV Class="paranum">25</DIV>
<DIV Class="Normal">The type of an imported or exported object shall 
be compatible with the convention specified in the corresponding <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>. 
</DIV>
<DIV Class="paranum">25.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>This implies, for example, 
that importing an Integer object might be illegal, whereas importing 
an object of type Interfaces.C.int would be permitted.&nbsp;</DIV>
<DIV Class="paranum">26</DIV>
<DIV Class="Normal">For an imported or exported subprogram, the result 
and parameter types shall each be compatible with the convention specified 
in the corresponding pragma.</DIV>
<DIV Class="paranum">27</DIV>
<DIV Class="Normal">The external name and link name <I>string</I>_<SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN>s 
of a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import or Export, and the <I>string</I>_<SPAN Class="swiss"><A HREF="AA-4-4.html#S0115">expression</A></SPAN> 
of a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Linker_Options, shall be static.&nbsp;</DIV>

<H4 Class="centered">Static Semantics</H4>
<DIV Class="paranum">28</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>representation pragma 
(Import)</I> [partial]}</SPAN> <A NAME="I7030"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
representation (Import)</I> [partial]}</SPAN> <A NAME="I7031"></A><SPAN STYLE="font-size: 80%">{<I>representation 
pragma (Export)</I> [partial]}</SPAN> <A NAME="I7032"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
representation (Export)</I> [partial]}</SPAN> <A NAME="I7033"></A><SPAN STYLE="font-size: 80%">{<I>representation 
pragma (Convention)</I> [partial]}</SPAN> <A NAME="I7034"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
representation (Convention)</I> [partial]}</SPAN> <A NAME="I7035"></A><SPAN STYLE="font-size: 80%">{<I>aspect 
of representation (convention, calling convention)</I> [partial]}</SPAN> 
<A NAME="I7036"></A><SPAN STYLE="font-size: 80%">{<I>convention (aspect 
of representation)</I>}</SPAN> <A NAME="I7037"></A>Import, Export, and 
Convention <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
are representation pragmas that specify the <I>convention</I> aspect 
of representation. <SPAN STYLE="font-size: 80%">{<I>aspect of representation 
(imported)</I> [partial]}</SPAN> <A NAME="I7038"></A><SPAN STYLE="font-size: 80%">{<I>imported 
(aspect of representation)</I>}</SPAN> <A NAME="I7039"></A><SPAN STYLE="font-size: 80%">{<I>aspect 
of representation (exported)</I> [partial]}</SPAN> <A NAME="I7040"></A><SPAN STYLE="font-size: 80%">{<I>exported 
(aspect of representation)</I>}</SPAN> <A NAME="I7041"></A>In addition, 
Import and Export <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
specify the <I>imported</I> and <I>exported</I> aspects of representation, 
respectively.</DIV>
<DIV Class="paranum">29</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>program unit pragma 
(Import)</I> [partial]}</SPAN> <A NAME="I7042"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
program unit (Import)</I> [partial]}</SPAN> <A NAME="I7043"></A><SPAN STYLE="font-size: 80%">{<I>program 
unit pragma (Export)</I> [partial]}</SPAN> <A NAME="I7044"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
program unit (Export)</I> [partial]}</SPAN> <A NAME="I7045"></A><SPAN STYLE="font-size: 80%">{<I>program 
unit pragma (Convention)</I> [partial]}</SPAN> <A NAME="I7046"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
program unit (Convention)</I> [partial]}</SPAN> <A NAME="I7047"></A>An 
interfacing pragma is a program unit pragma when applied to a program 
unit (see <A HREF="AA-10-1-5.html">10.1.5</A>).</DIV>
<DIV Class="paranum">30</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">An interfacing pragma 
defines the convention of the entity denoted by the <SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN>. 
The convention represents the calling convention or representation convention 
of the entity. For an access-to-subprogram type, it represents the calling 
convention of designated subprograms. In addition:&nbsp;</DIV>
<DIV Class="paranum">31</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import specifies that the entity is defined externally (that is, outside 
the Ada program).</LI></UL>
<DIV Class="paranum">32</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Export specifies that the entity is used externally.</LI></UL>
<DIV Class="paranum">33</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import or Export optionally specifies an entity's external name, link 
name, or both.&nbsp;</LI></UL>
<DIV Class="paranum">34</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>external name</I>}</SPAN> 
<A NAME="I7048"></A>An <I>external name</I> is a string value for the 
name used by a foreign language program either for an entity that an 
Ada program imports, or for referring to an entity that an Ada program 
exports.</DIV>
<DIV Class="paranum">35</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>link name</I>}</SPAN> 
<A NAME="I7049"></A>A <I>link name</I> is a string value for the name 
of an exported or imported entity, based on the conventions of the foreign 
language's compiler in interfacing with the system's linker tool.</DIV>
<DIV Class="paranum">36</DIV>
<DIV Class="Normal">The meaning of link names is implementation defined. 
If neither a link name nor the Address attribute of an imported or exported 
entity is specified, then a link name is chosen in an implementation-defined 
manner, based on the external name if one is specified.&nbsp;</DIV>
<DIV Class="paranum">36.a</DIV>
<DIV Class="Annotations"><B>Implementation defined:&nbsp;</B>The meaning of 
link names.</DIV>
<DIV Class="paranum">36.b</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>For example, an implementation 
might always prepend &quot;_&quot;, and then pass it to the system linker. 
</DIV>
<DIV Class="paranum">36.c</DIV>
<DIV Class="Annotations"><B>Implementation defined:&nbsp;</B>The manner of 
choosing link names when neither the link name nor the address of an 
imported or exported entity is specified.</DIV>
<DIV Class="paranum">36.d</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>Normally, this will be 
the entity's defining name, or some simple transformation thereof.&nbsp;</DIV>
<DIV Class="paranum">37</DIV>
<DIV Class="Normal">Pragma Linker_Options has the effect of passing its 
string argument as a parameter to the system linker (if one exists), 
if the immediately enclosing compilation unit is included in the partition 
being linked. The interpretation of the string argument, and the way 
in which the string arguments from multiple Linker_Options pragmas are 
combined, is implementation defined.&nbsp;</DIV>
<DIV Class="paranum">37.a</DIV>
<DIV Class="Annotations"><B>Implementation defined:&nbsp;</B>The effect of 
pragma Linker_Options.</DIV>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">38</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>elaboration (declaration 
named by a pragma Import)</I> [partial]}</SPAN> <A NAME="I7050"></A><SPAN STYLE="font-size: 80%">{<I>notwithstanding</I>}</SPAN> 
<A NAME="I7051"></A>Notwithstanding what this International Standard 
says elsewhere, the elaboration of a declaration denoted by the <SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN> 
of a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import does not create the entity. Such an elaboration has no other effect 
than to allow the defining name to denote the external entity.&nbsp;</DIV>
<DIV Class="paranum">38.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>This implies that default 
initializations are skipped. (Explicit initializations are illegal.) 
For example, an imported access object is <I>not</I> initialized to <B>null</B>.</DIV>
<DIV Class="paranum">38.b</DIV>
<DIV Class="Annotations">Note that the <SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN> 
in a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import might denote more than one declaration; in that case, the entity 
of all of those declarations will be the external entity.&nbsp;</DIV>
<DIV Class="paranum">38.c</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>This &ldquo;notwithstanding&rdquo; 
wording is better than saying &ldquo;unless named by a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import&rdquo; on every definition of elaboration. It says we recognize 
the contradiction, and this rule takes precedence.&nbsp;</DIV>

<H4 Class="centered">Erroneous Execution</H4>
<DIV Class="paranum">38.1/2</DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00320.TXT">AI95-00320-01</A></I>} 
<SPAN class="insert2"><SPAN STYLE="font-size: 80%">{<I>erroneous execution 
(cause)</I> [partial]}</SPAN> <A NAME="I7052"></A>It is the programmer's 
responsibility to ensure that the use of interfacing pragmas does not 
violate Ada semantics; otherwise, program execution is erroneous.</SPAN> 
</DIV>

<H4 Class="centered">Implementation Advice</H4>
<DIV Class="paranum">39</DIV>
<DIV Class="Normal">If an implementation supports pragma Export to a 
given language, then it should also allow the main subprogram to be written 
in that language. It should support some mechanism for invoking the elaboration 
of the Ada library units included in the system, and for invoking the 
finalization of the environment task. On typical systems, the recommended 
mechanism is to provide two subprograms whose link names are &quot;adainit&quot; 
and &quot;adafinal&quot;. Adainit should contain the elaboration code 
for library units. Adafinal should contain the finalization code. These 
subprograms should have no effect the second and subsequent time they 
are called. <SPAN class="insert1"><SPAN STYLE="font-size: 80%">{<I>adainit</I>}</SPAN> 
<A NAME="I7053"></A><SPAN STYLE="font-size: 80%">{<I>adafinal</I>}</SPAN> 
<A NAME="I7054"></A><SPAN STYLE="font-size: 80%">{<I>Elaboration (of 
library units for a foreign language main subprogram)</I>}</SPAN> <A NAME="I7055"></A><SPAN STYLE="font-size: 80%">{<I>Finalization 
(of environment task for a foreign language main subprogram)</I>}</SPAN> 
<A NAME="I7056"></A></SPAN></DIV>
<DIV Class="paranum">39.a.1/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Implementation Advice: 
</B></SPAN><SPAN class="insert2">If <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Export is supported for a language, the main program should be able to 
be written in that language. Subprograms named &quot;adainit&quot; and 
&quot;adafinal&quot; should be provided for elaboration and finalization 
of the environment task.</SPAN></DIV>
<DIV Class="paranum">39.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>For example, if the main 
subprogram is written in C, it can call adainit before the first call 
to an Ada subprogram, and adafinal after the last.</DIV>
<DIV Class="paranum">40</DIV>
<DIV Class="Normal">Automatic elaboration of preelaborated packages should 
be provided when <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Export is supported.&nbsp;</DIV>
<DIV Class="paranum">40.a.1/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Implementation Advice: 
</B></SPAN><SPAN class="insert2">Automatic elaboration of preelaborated 
packages should be provided when <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Export is supported.</SPAN></DIV>
<DIV Class="paranum">41</DIV>
<DIV Class="Normal">For each supported convention <I>L</I> other than 
Intrinsic, an implementation should support Import and Export <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
for objects of <I>L</I>-compatible types and for subprograms, and <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Convention for <I>L</I>-eligible types and for subprograms, presuming 
the other language has corresponding features. <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">Pragma</A></SPAN> 
Convention need not be supported for scalar types.&nbsp;</DIV>
<DIV Class="paranum">41.a.1/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Implementation Advice: 
</B></SPAN><SPAN class="insert2">For each supported convention <I>L</I> 
other than Intrinsic, <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
Import and Export should be supported for objects of <I>L</I>-compatible 
types and for subprograms, and <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Convention should be supported for <I>L</I>-eligible types and for subprograms.</SPAN></DIV>
<DIV Class="paranum">41.a</DIV>
<DIV Class="Annotations"><B>Reason:&nbsp;</B>Pragma Convention is not necessary 
for scalar types, since the language interface packages declare scalar 
types corresponding to those provided by the respective foreign languages. 
</DIV>
<DIV Class="paranum">41.b/2</DIV>
<DIV Class="Annotations"><B>Implementation Note:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00114.TXT">AI95-00114-01</A></I>} 
If an implementation supports interfacing to <SPAN class="insert2">the 
</SPAN>C++<SPAN class="insert2">&nbsp;entities not supported by <A HREF="AA-B-3.html">B.3</A></SPAN>, 
it should do so via the convention identifier C_Plus_Plus (in additional 
to any C++-implementation-specific ones).&nbsp;</DIV>
<DIV Class="paranum">41.c/2</DIV>
<DIV Class="Annotations"><B>Reason:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00114.TXT">AI95-00114-01</A></I>} 
The reason for giving the advice about C++ is to encourage uniformity 
among implementations, given that the name of the language is not syntactically 
legal as an <SPAN Class="swiss"><A HREF="AA-2-3.html#S0002">identifier</A></SPAN>.<SPAN class="delete2">&nbsp;We place this advice in the AARM, rather than the RM95 proper, because 
(as of this writing) C++ is not an international standard, and we don't 
want to refer to a such a language from an international standard.</SPAN> 
</DIV>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">42</DIV>
<DIV Class="Notes">1&nbsp;&nbsp;Implementations may place restrictions 
on interfacing pragmas; for example, requiring each exported entity to 
be declared at the library level.&nbsp;</DIV>
<DIV Class="paranum">42.a</DIV>
<DIV Class="Annotations"><B>Proof:&nbsp;</B>Arbitrary restrictions are allowed 
by <A HREF="AA-13-1.html">13.1</A>.&nbsp;</DIV>
<DIV Class="paranum">42.b</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>Such a restriction might 
be to disallow them altogether. Alternatively, the implementation might 
allow them only for certain kinds of entities, or only for certain conventions. 
</DIV>
<DIV Class="paranum">43</DIV>
<DIV Class="Notes">2&nbsp;&nbsp;A <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import specifies the conventions for accessing external entities. It 
is possible that the actual entity is written in assembly language, but 
reflects the conventions of a particular language. For example, <B>pragma</B> 
Import(Ada, ...) can be used to interface to an assembly language routine 
that obeys the Ada compiler's calling conventions.</DIV>
<DIV Class="paranum">44</DIV>
<DIV Class="Notes">3&nbsp;&nbsp;To obtain &ldquo;call-back&rdquo; to 
an Ada subprogram from a foreign language environment, <B>pragma</B> 
Convention should be specified both for the access-to-subprogram type 
and the specific subprogram(s) to which 'Access is applied.</DIV>
<DIV Class="paranum">45</DIV>
<DIV Class="Notes">4&nbsp;&nbsp;It is illegal to specify more than one 
of Import, Export, or Convention for a given entity.</DIV>
<DIV Class="paranum">46</DIV>
<DIV Class="Notes">5&nbsp;&nbsp;The <SPAN Class="swiss"><A HREF="AA-13-1.html#S0285">local_name</A></SPAN> 
in an interfacing pragma can denote more than one entity in the case 
of overloading. Such a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
applies to all of the denoted entities.</DIV>
<DIV Class="paranum">47</DIV>
<DIV Class="Notes">6&nbsp;&nbsp;See also <A HREF="AA-13-8.html">13.8</A>, 
&ldquo;<A HREF="AA-13-8.html">Machine Code Insertions</A>&rdquo;.&nbsp;</DIV>
<DIV Class="paranum">47.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>The Intrinsic convention 
(see <A HREF="AA-6-3-1.html">6.3.1</A>) implies that the entity is somehow 
&ldquo;built in&rdquo; to the implementation. Thus, it generally does 
not make sense for users to specify Intrinsic in a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import. The intention is that only implementations will specify Intrinsic 
in a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Import. The language also defines certain subprograms to be Intrinsic. 
</DIV>
<DIV Class="paranum">47.b</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>There are many imaginable 
interfacing pragmas that don't make any sense. For example, setting the 
Convention of a protected procedure to Ada is probably wrong. Rather 
than enumerating all such cases, however, we leave it up to implementations 
to decide what is sensible.&nbsp;</DIV>
<DIV Class="paranum">48</DIV>
<DIV Class="Notes">7&nbsp;&nbsp;If both External_Name and Link_Name are 
specified for an Import or Export pragma, then the External_Name is ignored.</DIV>
<DIV Class="paranum">49/2</DIV>
<DIV Class="Notes"><SPAN STYLE="font-size: 80%"><I>This paragraph was 
deleted.</I></SPAN><SPAN class="delete2">8&nbsp;&nbsp;</SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00320.TXT">AI95-00320-01</A></I>} 
<SPAN class="delete2">An interfacing pragma might result in an effect 
that violates Ada semantics.</SPAN>&nbsp;</DIV>

<H4 Class="centered">Examples</H4>
<DIV Class="paranum">50</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><I>Example of interfacing 
pragmas:</I>&nbsp;</DIV>
<DIV Class="paranum">51</DIV>
<DIV Class="Examples"><B>package</B>&nbsp;Fortran_Library&nbsp;<B>is</B><BR>
&nbsp;&nbsp;<B>function</B>&nbsp;Sqrt&nbsp;(X&nbsp;:&nbsp;Float)&nbsp;<B>return</B>&nbsp;Float;<BR>
&nbsp;&nbsp;<B>function</B>&nbsp;Exp&nbsp;&nbsp;(X&nbsp;:&nbsp;Float)&nbsp;<B>return</B>&nbsp;Float;<BR>
<B>private</B><BR>
&nbsp;&nbsp;<B>pragma</B>&nbsp;Import(Fortran,&nbsp;Sqrt);<BR>
&nbsp;&nbsp;<B>pragma</B>&nbsp;Import(Fortran,&nbsp;Exp);<BR>
<B>end</B>&nbsp;Fortran_Library;</DIV>

<H4 Class="centered">Extensions to Ada 83</H4>
<DIV Class="paranum">51.a</DIV>
<DIV Class="Annotations">{<I>extensions to Ada 83</I>} <A NAME="I7057"></A>Interfacing 
pragmas are new to Ada 95. Pragma Import replaces Ada 83's pragma Interface. 
Existing implementations can continue to support pragma Interface for 
upward compatibility.&nbsp;</DIV>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<DIV Class="paranum">51.b/2</DIV>
<DIV Class="Annotations">{<I><A HREF="defect1.html#8652/0058">8652/0058</A></I>} 
<SPAN class="insert2"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00036.TXT">AI95-00036-01</A></I>} 
<SPAN class="insert2"><B>Corrigendum:</B> Clarified that <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN>s 
Import and Export work like a subprogram call; parameters cannot be omitted 
unless named notation is used. (Reordering is still not permitted, however.)</SPAN></DIV>
<DIV Class="paranum">51.c/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00320.TXT">AI95-00320-01</A></I>} 
<SPAN class="insert2">Added wording to say all bets are off if foreign 
code doesn't follow the semantics promised by the Ada specifications.</SPAN> 
</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-B.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-B-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
